<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Straight to the Comments</title>
    <script src="https://cdn.tailwindcss.com"></script>
         <style>
         .footprint-bar {
             transition: width 0.3s ease, background 0.3s ease;
         }
         .platform-card {
             transition: all 0.3s ease;
         }
         .comment-btn {
             transition: all 0.2s ease;
         }
         .comment-btn:hover {
             transform: translateY(-1px);
             box-shadow: 0 4px 12px rgba(0,0,0,0.15);
         }
         .comment-btn:active {
             transform: translateY(0);
         }
         
         /* Touch-friendly improvements */
         @media (hover: none) and (pointer: coarse) {
             .comment-btn:hover {
                 transform: none;
                 box-shadow: none;
             }
             .comment-btn:active {
                 transform: scale(0.98);
                 box-shadow: 0 2px 8px rgba(0,0,0,0.1);
             }
         }
         
         /* Animations */
         @keyframes likeBounce {
             0%, 100% { transform: scale(1); }
             50% { transform: scale(1.2); }
         }
         
         @keyframes likeFloat {
             0% { transform: translateY(0) scale(1); opacity: 1; }
             100% { transform: translateY(-50px) scale(1.5); opacity: 0; }
         }
         
         @keyframes platformGlow {
             0%, 100% { box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
             50% { box-shadow: 0 8px 30px rgba(0,0,0,0.2); }
         }
         
                   @keyframes buttonPulse {
              0%, 100% { transform: scale(1); }
              50% { transform: scale(1.05); }
          }
          
          @keyframes footprintPop {
              0% { opacity: 0; transform: scale(0.5) translateY(10px); }
              20% { opacity: 1; transform: scale(1.2) translateY(0); }
              80% { opacity: 1; transform: scale(1) translateY(0); }
              100% { opacity: 0; transform: scale(0.8) translateY(-10px); }
          }
         
         .like-animation {
             animation: likeBounce 0.6s ease-out;
         }
         
         .like-float {
             position: absolute;
             pointer-events: none;
             animation: likeFloat 1s ease-out forwards;
         }
         
         .platform-glow {
             animation: platformGlow 2s ease-in-out infinite;
         }
         
                   .button-pulse {
              animation: buttonPulse 2s ease-in-out infinite;
          }
          
          .footprint-pop {
              animation: footprintPop 1.5s ease-out forwards;
          }
         
         /* Color enhancements */
         .hypebeast-btn { background: linear-gradient(135deg, #ff6b6b, #ffa500); color: white; }
         .supporter-btn { background: linear-gradient(135deg, #4ecdc4, #44a08d); color: white; }
         .jokester-btn { background: linear-gradient(135deg, #ffe66d, #ffa726); color: white; }
         .roaster-btn { background: linear-gradient(135deg, #ff5722, #e91e63); color: white; }
         .critic-btn { background: linear-gradient(135deg, #9c27b0, #673ab7); color: white; }
         .hater-btn { background: linear-gradient(135deg, #f44336, #d32f2f); color: white; }
         
         .style-btn {
             border: none !important;
             font-weight: 600;
             text-shadow: 0 1px 2px rgba(0,0,0,0.3);
         }
         
         .style-btn:hover {
             filter: brightness(1.1);
             transform: translateY(-2px) scale(1.02);
         }
         
         /* Touch-friendly style buttons */
         @media (hover: none) and (pointer: coarse) {
             .style-btn:hover {
                 filter: none;
                 transform: none;
             }
             .style-btn:active {
                 filter: brightness(1.1);
                 transform: scale(0.98);
             }
         }
     </style>
</head>
<body class="min-h-screen bg-neutral-50 text-neutral-900">
    <div id="app" class="flex flex-col items-center py-6">
                                                     <!-- Top Bar -->
          <div id="topBar" class="flex items-center justify-between w-full max-w-5xl p-3">
              <!-- Back to Menu Button (hidden by default) -->
              <button 
                  id="backToMenuBtn" 
                  onclick="backToMenu()" 
                  class="px-3 py-1 text-sm bg-neutral-200 hover:bg-neutral-300 rounded-lg transition-colors"
                  style="display: none;"
              >
                  ‚Üê Back to Menu
              </button>
              
              <!-- Center footprint indicator (hidden by default) -->
              <div id="footprintIndicator" class="absolute left-1/2 transform -translate-x-1/2 opacity-0">
                  <div class="text-2xl text-neutral-400 select-none">üë£</div>
              </div>
              
              <div class="text-right">
                  <div class="text-neutral-400 text-xs">Likes</div>
                  <div id="likeCount" class="text-2xl font-semibold tabular-nums">0</div>
              </div>
          </div>

                 <!-- Start Menu -->
         <div id="startMenu" class="max-w-4xl w-full flex flex-col items-center gap-4 sm:gap-8 py-6 sm:py-12 px-4">
             <!-- Stylized Title -->
             <div class="text-center">
                 <h1 class="text-3xl sm:text-5xl lg:text-6xl font-black bg-gradient-to-r from-purple-600 via-pink-500 to-orange-400 bg-clip-text text-transparent mb-2 sm:mb-4 drop-shadow-lg">
                     STRAIGHT TO THE
                 </h1>
                 <h1 class="text-4xl sm:text-6xl lg:text-7xl font-black bg-gradient-to-r from-blue-600 via-cyan-500 to-teal-400 bg-clip-text text-transparent mb-4 sm:mb-6 drop-shadow-lg">
                     COMMENTS
                 </h1>
                 <div class="w-24 sm:w-32 h-1 bg-gradient-to-r from-purple-600 to-blue-600 mx-auto rounded-full mb-6 sm:mb-8"></div>
             </div>
             
             <!-- Game Description -->
             <div class="text-center max-w-2xl px-4">
                 <p class="text-lg sm:text-xl text-neutral-700 mb-3 sm:mb-4 font-medium">
                     Navigate 5 different social platforms and chase those likes!
                 </p>
                                   <p class="text-base sm:text-lg text-neutral-600 mb-6 sm:mb-8">
                      Glance at the post, go straight to the comments! And earn the most likes! Choose your comment style wisely!
                  </p>
                 
                 <!-- Platform Preview -->
                 <div class="grid grid-cols-3 sm:grid-cols-5 gap-2 sm:gap-3 mb-6 sm:mb-8">
                     <div class="flex flex-col items-center p-2 sm:p-3 bg-white rounded-xl shadow-sm border border-neutral-200">
                         <div class="text-xl sm:text-2xl mb-1 sm:mb-2">üì∏</div>
                         <div class="text-xs font-medium text-neutral-700">Instagram</div>
                     </div>
                     <div class="flex flex-col items-center p-2 sm:p-3 bg-white rounded-xl shadow-sm border border-neutral-200">
                         <div class="text-xl sm:text-2xl mb-1 sm:mb-2">üéµ</div>
                         <div class="text-xs font-medium text-neutral-700">TikTok</div>
                     </div>
                     <div class="flex flex-col items-center p-2 sm:p-3 bg-white rounded-xl shadow-sm border border-neutral-200">
                         <div class="text-xl sm:text-2xl mb-1 sm:mb-2">üì∫</div>
                         <div class="text-xs font-medium text-neutral-700">YouTube</div>
                     </div>
                     <div class="flex flex-col items-center p-2 sm:p-3 bg-white rounded-xl shadow-sm border border-neutral-200">
                         <div class="text-xl sm:text-2xl mb-1 sm:mb-2">üí¨</div>
                         <div class="text-xs font-medium text-neutral-700">Text</div>
                     </div>
                     <div class="flex flex-col items-center p-2 sm:p-3 bg-white rounded-xl shadow-sm border border-neutral-200">
                         <div class="text-xl sm:text-2xl mb-1 sm:mb-2">üéÆ</div>
                         <div class="text-xs font-medium text-neutral-700">Discord</div>
                     </div>
                 </div>
                 
                 <!-- Start Button -->
                 <button 
                     onclick="startGame()" 
                     class="px-8 sm:px-12 py-3 sm:py-4 bg-gradient-to-r from-purple-600 to-blue-600 text-white font-bold text-lg sm:text-xl rounded-2xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 border-0"
                 >
                     üöÄ START COMMENTING
                 </button>
             </div>
         </div>

                             <!-- Game Container (hidden by default) -->
           <div id="gameContainer" class="max-w-5xl w-full flex flex-col items-center gap-4 px-4" style="display: none;">
               <div class="flex flex-col items-center gap-3">
                 <div id="roundInfo" class="text-xs text-neutral-500">Round 1 / 5</div>
                                                                                                           <div class="flex gap-4 w-full max-w-4xl">
                                        <!-- Post Card (Left Side) -->
                                        <div id="platformCard" class="platform-card bg-white rounded-2xl shadow p-3 border border-neutral-200 w-full max-w-[360px] relative overflow-visible min-h-[600px]">
                                            <!-- Platform content will be populated by JavaScript -->
                                        </div>
                                        
                                        <!-- Comment Interface (Right Side) -->
                                        <div id="commentInterface" class="bg-white rounded-2xl shadow p-3 border border-neutral-200 w-full max-w-[360px] min-h-[600px] flex flex-col" style="display: none;">
                                            <!-- Comment interface will be populated by JavaScript -->
                                        </div>
                                    </div>
                 
             </div>
         </div>

        <!-- Results Screen (hidden by default) -->
        <div id="resultsScreen" class="max-w-3xl w-full bg-white border border-neutral-200 rounded-2xl shadow p-4 sm:p-6 mx-4" style="display: none;">
            <!-- Results content will be populated by JavaScript -->
        </div>
    </div>

    <script>
        // Game Data
                 const PLATFORMS = [
             {
                 key: "instagram",
                 label: "Instagram",
                 orientation: "vertical",
                 accent: "#d62976",
                 icon: "üì∏",
                 media: {
                     type: "image",
                     src: "./media/instagram-fashion.jpg",
                     alt: "Fashion outfit selfie with trendy lighting"
                 },
                                   existingComments: [
                      { text: "Girl really thought she ate with this caption üíÄ", likes: 342, author: "@antonego" }
                  ]
             },
                                                   {
                  key: "tiktok",
                  label: "TikTok",
                  orientation: "vertical",
                  accent: "#25F4EE",
                  icon: "üéµ",
                  media: {
                      type: "image",
                      src: "./media/instagram-fashion.jpg",
                      alt: "Dance video with smooth transitions"
                  },
                                                        existingComments: [
                        { text: "The dance moves are fighting for their life in court üíÉ", likes: 567, author: "@antonego" }
                    ]
              },
                         {
                 key: "youtube",
                 label: "YouTube",
                 orientation: "vertical",
                 accent: "#FF0000",
                 icon: "üì∫",
                 media: {
                     type: "image",
                     src: "./media/youtube-tutorial.jpg",
                     alt: "YouTube tutorial thumbnail with clickbait text"
                 },
                                   existingComments: [
                      { text: "The intro is longer than my attention span üíÄ", likes: 892, author: "@antonego" }
                  ]
             },
                         {
                 key: "text",
                 label: "Text Message",
                 orientation: "vertical",
                 accent: "#10b981",
                 icon: "üí¨",
                 media: {
                     type: "image",
                     src: "./media/text-message.jpg",
                     alt: "Phone screenshot showing text conversation"
                 },
                                   existingComments: [
                      { text: "Your excuses are getting more creative by the day üíÄ", likes: 45, author: "@antonego" }
                  ]
             },
                         {
                 key: "discord",
                 label: "Discord",
                 orientation: "vertical",
                 accent: "#5865F2",
                 icon: "üéÆ",
                 media: {
                     type: "image",
                     src: "./media/discord-gaming.jpg",
                     alt: "Gaming setup with Discord interface"
                 },
                                   existingComments: [
                      { text: "Your gaming skills are giving me secondhand embarrassment üíÄ", likes: 67, author: "@antonego" }
                  ]
             }
        ];

                 const STYLES = [
             { key: "hypebeast", label: "Stan", emoji: "üí´" },
             { key: "supporter", label: "Fan", emoji: "‚≠ê" },
             { key: "jokester", label: "Jokester", emoji: "üòÑ" },
             { key: "roaster", label: "Roaster", emoji: "üî•" },
             { key: "critic", label: "Critic", emoji: "üßê" },
             { key: "hater", label: "Hater", emoji: "üò†" }
         ];

        const DOUBLE_DOWN_OPTIONS = {
            instagram: {
                hypebeast: [
                    "No cap, this is literally art üé®",
                    "You're actually built different, respect ‚úä"
                ],
                supporter: [
                    "Seriously, you inspire me to be better üåü",
                    "The world needs more people like you üí´"
                ],
                jokester: [
                    "I'm literally screenshotting this for my therapist üòÇ",
                    "You're the main character and we're all NPCs üé≠"
                ],
                roaster: [
                    "Okay but fr tho, who taught you to dress? üíÄ",
                    "This caption reads like a LinkedIn post ü§°"
                ],
                critic: [
                    "The composition is actually hurting my eyes üëÅÔ∏è",
                    "Maybe stick to selfies next time üì∏"
                ],
                hater: [
                    "Actually embarrassing, delete your account üóëÔ∏è",
                    "This is why I don't use social media anymore üíÄ"
                ]
            },
            tiktok: {
                hypebeast: [
                    "This is literally the best thing I've ever seen üî•",
                    "You're going viral, I'm calling it now üìà"
                ],
                supporter: [
                    "You're making the internet a better place üíï",
                    "Keep being you, the world needs this energy ‚ú®"
                ],
                jokester: [
                    "I'm literally showing this to everyone I know üò≠",
                    "You're the internet's favorite person rn üåü"
                ],
                roaster: [
                    "The transitions are giving PowerPoint presentation üíÄ",
                    "This audio is fighting for its life in court üé§"
                ],
                critic: [
                    "The pacing is giving me anxiety üò∞",
                    "Maybe stick to one trend at a time üìâ"
                ],
                hater: [
                    "This is why TikTok is dying üíÄ",
                    "Actually painful to watch, reported üö®"
                ]
            },
            youtube: {
                hypebeast: [
                    "This is literally the best video on YouTube üèÜ",
                    "You're the GOAT, no questions asked üêê"
                ],
                supporter: [
                    "You're helping so many people with this content üôè",
                    "The effort you put in shows, thank you üí™"
                ],
                jokester: [
                    "I'm literally subscribing to everything you make üòÇ",
                    "You're the only YouTuber I trust anymore üéØ"
                ],
                roaster: [
                    "The intro is longer than my attention span üíÄ",
                    "This thumbnail is giving clickbait realness üé£"
                ],
                critic: [
                    "The audio mixing is actually painful üîä",
                    "Maybe stick to shorter videos next time ‚è∞"
                ],
                hater: [
                    "This is why I don't watch YouTube anymore üíÄ",
                    "Actually the worst content I've ever seen üóëÔ∏è"
                ]
            },
            text: {
                hypebeast: [
                    "You're literally the best friend anyone could ask for üíé",
                    "I'm so lucky to have you in my life ‚ú®"
                ],
                supporter: [
                    "You make everyone around you better üåü",
                    "The world is better because you're in it üí´"
                ],
                jokester: [
                    "I'm literally telling everyone about you üòÇ",
                    "You're the friend everyone wishes they had üé≠"
                ],
                roaster: [
                    "Your excuses are getting more creative by the day üíÄ",
                    "This text is giving me secondhand embarrassment ü§°"
                ],
                critic: [
                    "Maybe think before you send next time ü§î",
                    "This could have been an email üìß"
                ],
                hater: [
                    "You're literally the worst friend ever üíÄ",
                    "This is why people ghost you üö™"
                ]
            },
            discord: {
                hypebeast: [
                    "You're literally the MVP of this server üèÜ",
                    "This server wouldn't be the same without you üíé"
                ],
                supporter: [
                    "You make this community so much better üíï",
                    "Everyone here appreciates you so much ‚ú®"
                ],
                jokester: [
                    "I'm literally screenshotting everything you say üòÇ",
                    "You're the funniest person in any server üé≠"
                ],
                roaster: [
                    "Your gaming skills are giving me secondhand embarrassment üíÄ",
                    "This art looks like it was made by a bot ü§ñ"
                ],
                critic: [
                    "Maybe read the rules before posting üìú",
                    "This is why we have moderation üõ°Ô∏è"
                ],
                hater: [
                    "You're literally the worst member here üíÄ",
                    "This is why servers die üö™"
                ]
            }
        };

        const COMMENT_OPTIONS = {
            instagram: {
                hypebeast: [
                    "Fit is fire fr üî•",
                    "Colors go crazy, lowkey vibes ‚ú®"
                ],
                supporter: [
                    "Proud of you! Keep going ‚Äî you got this üí™",
                    "You worked hard on this, we notice it üëè"
                ],
                jokester: [
                    "Bro said 'new phone who dis' pose üòÇ",
                    "That shadow got main character energy üé≠"
                ],
                roaster: [
                    "Bro dressed like a traffic cone üö¶",
                    "Caption trying too hard, corn meter rising üåΩ"
                ],
                critic: [
                    "Lighting's harsh tbh, maybe try golden hour next time üì∏",
                    "Crop feels tight, rule of thirds could help üìê"
                ],
                hater: [
                    "Delete this üíÄ",
                    "Cringe alert, muting fr üö®"
                ]
            },
            tiktok: {
                hypebeast: [
                    "Beat goes crazy, looping this üî•",
                    "Transitions smooth, chef mode editing üë®‚Äçüç≥"
                ],
                supporter: [
                    "Keep posting! We love consistent creators üíï",
                    "Thanks for the laugh, wholesome vibes üòä"
                ],
                jokester: [
                    "This my Roman Empire now üèõÔ∏è",
                    "POV: you're the main quest üéÆ"
                ],
                roaster: [
                    "Transition jump scare, I'm suing my FYP üò±",
                    "Audio fighting for its life, mic said nope üé§"
                ],
                critic: [
                    "Cut 2 drags, pacing fixes everything ‚úÇÔ∏è",
                    "Color grade off, try warmer midtones üé®"
                ],
                hater: [
                    "Not funny lol, pack it up üì¶",
                    "Who asked, touch grass DLC üå±"
                ]
            },
            youtube: {
                hypebeast: [
                    "Intro slaps, subs incoming üéµ",
                    "Thumbnail clean, title wins üèÜ"
                ],
                supporter: [
                    "This helped a lot, bookmarked üìö",
                    "You put effort, appreciated üôè"
                ],
                jokester: [
                    "That mic said ASMR not tutorial üé§",
                    "Editor deserves a raise, oh wait it's you üí∞"
                ],
                roaster: [
                    "Timestamps where, lost in the void üï≥Ô∏è",
                    "Intro too long, skip speedrun ‚è≠Ô∏è"
                ],
                critic: [
                    "Audio peaks, limiter needed üîä",
                    "B-roll repeats, need variety üé¨"
                ],
                hater: [
                    "Worst video today, delete channel üóëÔ∏è",
                    "Skill issue, unsubbed üëé"
                ]
            },
            text: {
                hypebeast: [
                    "W idea, let's run it üöÄ",
                    "Proud of u, lowkey inspiring ‚ú®"
                ],
                supporter: [
                    "That sounded tough, here for you ü§ó",
                    "Nice move, respect the honesty üíØ"
                ],
                jokester: [
                    "I'll bring the snacks, you bring the chaos üçø",
                    "Plot twist energy, season 3 arc üì∫"
                ],
                roaster: [
                    "Bro you always late, L clock ‚è∞",
                    "Excuse speedrun PB, world champ üèÖ"
                ],
                critic: [
                    "That text could land wrong, try softer ü§î",
                    "Timing bad, they're busy, send later üì±"
                ],
                hater: [
                    "Nobody cares, cry about it üò≠",
                    "Embarrassing take, delulu ü§°"
                ]
            },
            discord: {
                hypebeast: [
                    "GG team, clean comms üéÆ",
                    "Art share goes hard, pinned? üé®"
                ],
                supporter: [
                    "Welcome new folks, glad you're here üëã",
                    "Mod team cooked, thanks y'all üë®‚Äçüíº"
                ],
                jokester: [
                    "Ping @everyone speedrun, mods typing‚Ä¶ ‚ö°",
                    "Cat tax or ban, rules are rules üê±"
                ],
                roaster: [
                    "You camped spawn, peak cringe üèïÔ∏è",
                    "Fanart traced? Looks sus üïµÔ∏è"
                ],
                critic: [
                    "Thread drift, back on topic? üßµ",
                    "Overposting, slow mode pls üêå"
                ],
                hater: [
                    "Mods asleep, chaos time üòà",
                    "Server lame, leaving üëã"
                ]
            }
        };

        const NPC_REPLIES = {
            instagram: {
                hypebeast: {
                    "Fit is fire fr üî•": "OMG thank you so much! ü•∫ You're literally the sweetest! This made my entire week!",
                    "Colors go crazy, lowkey vibes ‚ú®": "You're making my day with these comments! ü•∞ The color palette was everything!"
                },
                supporter: {
                    "Proud of you! Keep going ‚Äî you got this üí™": "Thank you so much! That means a lot to me üòä You're the best supporter ever!",
                    "You worked hard on this, we notice it üëè": "You're so kind! Really appreciate the support and recognition!"
                },
                jokester: {
                    "Bro said 'new phone who dis' pose üòÇ": "LMAO you're hilarious! üòÇ This made my day! Not you calling out my modeling skills!",
                    "That shadow got main character energy üé≠": "Not you coming back with more jokes! üò≠ I can't! My shadow is literally the star now!"
                },
                roaster: {
                    "Bro dressed like a traffic cone üö¶": "Okay, I see you coming for me! üòÖ But honestly, fair play - orange is my power color!",
                    "Caption trying too hard, corn meter rising üåΩ": "You're really not letting up with these roasts! üòÇ The corn puns are actually fire though!"
                },
                critic: {
                    "Lighting's harsh tbh, maybe try golden hour next time üì∏": "Thanks for the feedback! Always trying to improve üôè Golden hour is definitely the move!",
                    "Crop feels tight, rule of thirds could help üìê": "I appreciate you taking the time to give thoughtful feedback! ü§ù Will definitely work on my composition!"
                },
                hater: {
                    "Delete this üíÄ": "I appreciate the honesty, even if it's harsh üòÖ Maybe I'll try a different approach next time...",
                    "Cringe alert, muting fr üö®": "You're really committed to this energy, huh? üòÖ Hope you find content that vibes with you better!"
                }
            },
            tiktok: {
                hypebeast: {
                    "Beat goes crazy, looping this üî•": "OMG thank you! You're literally the best! ü•∫üíÉ The beat really did hit different!",
                    "Transitions smooth, chef mode editing üë®‚Äçüç≥": "You're making me blush! Thank you so much! ü•∞ The editing took forever but worth it!"
                },
                supporter: {
                    "Keep posting! We love consistent creators üíï": "Thank you! Your support means everything! üòä Consistency is key and you're helping me stay motivated!",
                    "Thanks for the laugh, wholesome vibes üòä": "You're so sweet! Really appreciate the love and positive energy!"
                },
                jokester: {
                    "This my Roman Empire now üèõÔ∏è": "LMAO you're killing me! üòÇ This made my day! Not you making my silly video your entire personality!",
                    "POV: you're the main quest üéÆ": "Not you being the funniest person ever! üò≠ I can't! Side quests are crying rn!"
                },
                roaster: {
                    "Transition jump scare, I'm suing my FYP üò±": "Okay, I see you coming for me! üòÖ But honestly, you're funny - the jump scare was intentional!",
                    "Audio fighting for its life, mic said nope üé§": "You're really not letting up with these roasts! üòÇ My mic really did betray me though!"
                },
                critic: {
                    "Cut 2 drags, pacing fixes everything ‚úÇÔ∏è": "Thanks for the feedback! Always trying to improve üôè Pacing is definitely something I'm working on!",
                    "Color grade off, try warmer midtones üé®": "I appreciate you taking the time to give thoughtful feedback! ü§ù Color grading is my weak spot!"
                },
                hater: {
                    "Not funny lol, pack it up üì¶": "I appreciate the honesty, even if it's harsh üòÖ Comedy is subjective, I guess!",
                    "Who asked, touch grass DLC üå±": "You're really committed to this energy, huh? üòÖ Maybe we both need to touch some grass!"
                }
            },
            youtube: {
                hypebeast: {
                    "Intro slaps, subs incoming üéµ": "OMG thank you! You're literally the best! ü•∫üì± The intro took me forever to perfect!",
                    "Thumbnail clean, title wins üèÜ": "You're making my day! Thank you so much! ü•∞ Thumbnail design is my passion!"
                },
                supporter: {
                    "This helped a lot, bookmarked üìö": "Thank you! Your support means everything! üòä So glad the content was actually helpful!",
                    "You put effort, appreciated üôè": "You're so kind! Really appreciate the feedback and recognition of the work!"
                },
                jokester: {
                    "That mic said ASMR not tutorial üé§": "LMAO you're hilarious! üòÇ This made my day! My mic really does have a mind of its own!",
                    "Editor deserves a raise, oh wait it's you üí∞": "Not you being the funniest commenter! üò≠ I can't! I'm literally my own editor and I'm underpaid!"
                },
                roaster: {
                    "Timestamps where, lost in the void üï≥Ô∏è": "Okay, I see you coming for me! üòÖ But honestly, fair play - timestamps are a lost art!",
                    "Intro too long, skip speedrun ‚è≠Ô∏è": "You're really not letting up with these roasts! üòÇ The intro is definitely my guilty pleasure!"
                },
                critic: {
                    "Audio peaks, limiter needed üîä": "Thanks for the feedback! Always trying to improve üôè Audio mixing is definitely my Achilles heel!",
                    "B-roll repeats, need variety üé¨": "I appreciate you taking the time to give thoughtful feedback! ü§ù Variety is the spice of life!"
                },
                hater: {
                    "Worst video today, delete channel üóëÔ∏è": "I appreciate the honesty, even if it's harsh üòÖ Maybe this content wasn't for you!",
                    "Skill issue, unsubbed üëé": "You're really committed to this energy, huh? üòÖ Hope you find creators that match your standards!"
                }
            },
            text: {
                hypebeast: {
                    "W idea, let's run it üöÄ": "OMG thank you! You're literally the best friend ever! ü•∫üéì You always have the best ideas!",
                    "Proud of u, lowkey inspiring ‚ú®": "You're making me cry! Thank you so much! ü•∞ Your support means the world to me!"
                },
                supporter: {
                    "That sounded tough, here for you ü§ó": "Thank you! Your support means everything! üòä You're the best friend anyone could ask for!",
                    "Nice move, respect the honesty üíØ": "You're so kind! Really appreciate the friendship and understanding!"
                },
                jokester: {
                    "I'll bring the snacks, you bring the chaos üçø": "LMAO you're hilarious! üòÇ This made my day! The chaos-snack ratio is perfect!",
                    "Plot twist energy, season 3 arc üì∫": "Not you being the funniest friend! üò≠ I can't! My life is literally a TV show now!"
                },
                roaster: {
                    "Bro you always late, L clock ‚è∞": "Okay, I see you coming for me! üòÖ But honestly, you're funny - time management is not my strong suit!",
                    "Excuse speedrun PB, world champ üèÖ": "You're really not letting up with these roasts! üòÇ I'm literally the excuse Olympics champion!"
                },
                critic: {
                    "That text could land wrong, try softer ü§î": "Thanks for the feedback! Always trying to improve üôè Communication is definitely something I'm working on!",
                    "Timing bad, they're busy, send later üì±": "I appreciate you taking the time to give thoughtful advice! ü§ù Timing is everything!"
                },
                hater: {
                    "Nobody cares, cry about it üò≠": "I appreciate the honesty, even if it's harsh üòÖ Maybe I should keep some things to myself!",
                    "Embarrassing take, delulu ü§°": "You're really committed to this energy, huh? üòÖ Hope you find friends who appreciate your perspective!"
                }
            },
            discord: {
                hypebeast: {
                    "GG team, clean comms üéÆ": "OMG thank you! You're literally the best! ü•∫üéÆ Communication is key in any team!",
                    "Art share goes hard, pinned? üé®": "You're making my day! Thank you so much! ü•∞ The art community here is amazing!"
                },
                supporter: {
                    "Welcome new folks, glad you're here üëã": "Thank you! Your support means everything! üòä Making everyone feel welcome is so important!",
                    "Mod team cooked, thanks y'all üë®‚Äçüíº": "You're so kind! Really appreciate the encouragement and recognition!"
                },
                jokester: {
                    "Ping @everyone speedrun, mods typing‚Ä¶ ‚ö°": "LMAO you're hilarious! üòÇ This made my day! Not you speedrunning the mods' patience!",
                    "Cat tax or ban, rules are rules üê±": "Not you being the funniest person in the server! üò≠ I can't! The cat tax is sacred!"
                },
                roaster: {
                    "You camped spawn, peak cringe üèïÔ∏è": "Okay, I see you coming for me! üòÖ But honestly, fair play - camping is a valid strategy!",
                    "Fanart traced? Looks sus üïµÔ∏è": "You're really not letting up with these roasts! üòÇ The art community detectives are on the case!"
                },
                critic: {
                    "Thread drift, back on topic? üßµ": "Thanks for the feedback! Always trying to improve üôè Keeping conversations focused is important!",
                    "Overposting, slow mode pls üêå": "I appreciate you taking the time to give thoughtful feedback! ü§ù Moderation is key!"
                },
                hater: {
                    "Mods asleep, chaos time üòà": "I appreciate the honesty, even if it's harsh üòÖ The server has its own rhythm!",
                    "Server lame, leaving üëã": "You're really committed to this energy, huh? üòÖ Hope you find a community that vibes with you!"
                }
            }
        };

        const DOUBLE_DOWN_NPC_REPLIES = {
            instagram: {
                hypebeast: {
                    "No cap, this is literally art üé®": "OMG STOP! ü•∫ You're literally making me cry! This is the sweetest thing anyone has ever said to me!",
                    "You're actually built different, respect ‚úä": "I'm literally speechless! üò≠ You're the one who's built different for being so kind!"
                },
                supporter: {
                    "Seriously, you inspire me to be better üåü": "You're literally the inspiration! üòä Your words mean more than you know!",
                    "The world needs more people like you üí´": "I'm crying happy tears! ü•∫ You're the one making the world better!"
                },
                jokester: {
                    "I'm literally screenshotting this for my therapist üòÇ": "LMAO I'M DYING! üòÇüò≠ Not you making my post therapy material!",
                    "You're the main character and we're all NPCs üé≠": "I CAN'T BREATHE! üò≠üòÇ You're literally the funniest person ever!"
                },
                roaster: {
                    "Okay but fr tho, who taught you to dress? üíÄ": "Okay, you got me there! üòÖ But honestly, fashion is subjective!",
                    "This caption reads like a LinkedIn post ü§°": "LMAO you're not wrong! üòÇ I was feeling professional that day!"
                },
                critic: {
                    "The composition is actually hurting my eyes üëÅÔ∏è": "Ouch! üòÖ Maybe I should stick to simpler shots next time!",
                    "Maybe stick to selfies next time üì∏": "Fair point! üòÖ Selfies are definitely my comfort zone!"
                },
                hater: {
                    "Actually embarrassing, delete your account üóëÔ∏è": "I appreciate the honesty, even if it's harsh üòÖ Maybe social media isn't for me!",
                    "This is why I don't use social media anymore üíÄ": "You're really committed to this energy, huh? üòÖ Hope you find content you like!"
                }
            },
            tiktok: {
                hypebeast: {
                    "This is literally the best thing I've ever seen üî•": "OMG STOP! ü•∫ You're literally making me cry! This is the best compliment ever!",
                    "You're going viral, I'm calling it now üìà": "I'm literally speechless! üò≠ You're the one who's going viral for being so sweet!"
                },
                supporter: {
                    "You're making the internet a better place üíï": "You're literally the one making it better! üòä Your kindness is everything!",
                    "Keep being you, the world needs this energy ‚ú®": "I'm crying happy tears! ü•∫ You're the one the world needs!"
                },
                jokester: {
                    "I'm literally showing this to everyone I know üò≠": "LMAO I'M DYING! üòÇüò≠ Not you making me famous to your friends!",
                    "You're the internet's favorite person rn üåü": "I CAN'T BREATHE! üò≠üòÇ You're literally the internet's favorite!"
                },
                roaster: {
                    "The transitions are giving PowerPoint presentation üíÄ": "Okay, you got me there! üòÖ But PowerPoint transitions are underrated!",
                    "This audio is fighting for its life in court üé§": "LMAO you're not wrong! üòÇ My mic really did betray me!"
                },
                critic: {
                    "The pacing is giving me anxiety üò∞": "Ouch! üòÖ Maybe I should work on my timing!",
                    "Maybe stick to one trend at a time üìâ": "Fair point! üòÖ I do get a bit excited with trends!"
                },
                hater: {
                    "This is why TikTok is dying üíÄ": "I appreciate the honesty, even if it's harsh üòÖ Maybe I'm part of the problem!",
                    "Actually painful to watch, reported üö®": "You're really committed to this energy, huh? üòÖ Hope you find better content!"
                }
            },
            youtube: {
                hypebeast: {
                    "This is literally the best video on YouTube üèÜ": "OMG STOP! ü•∫ You're literally making me cry! This is the highest praise ever!",
                    "You're the GOAT, no questions asked üêê": "I'm literally speechless! üò≠ You're the one who's the GOAT for being so kind!"
                },
                supporter: {
                    "You're helping so many people with this content üôè": "You're literally the one helping! üòä Your support means everything!",
                    "The effort you put in shows, thank you üí™": "I'm crying happy tears! ü•∫ You're the one putting in effort to be kind!"
                },
                jokester: {
                    "I'm literally subscribing to everything you make üòÇ": "LMAO I'M DYING! üòÇüò≠ Not you becoming my biggest fan!",
                    "You're the only YouTuber I trust anymore üéØ": "I CAN'T BREATHE! üò≠üòÇ You're literally the most trustworthy viewer!"
                },
                roaster: {
                    "The intro is longer than my attention span üíÄ": "Okay, you got me there! üòÖ But intros are my guilty pleasure!",
                    "This thumbnail is giving clickbait realness üé£": "LMAO you're not wrong! üòÇ Clickbait is an art form!"
                },
                critic: {
                    "The audio mixing is actually painful üîä": "Ouch! üòÖ Maybe I should invest in better equipment!",
                    "Maybe stick to shorter videos next time ‚è∞": "Fair point! üòÖ I do tend to ramble!"
                },
                hater: {
                    "This is why I don't watch YouTube anymore üíÄ": "I appreciate the honesty, even if it's harsh üòÖ Maybe I'm part of the problem!",
                    "Actually the worst content I've ever seen üóëÔ∏è": "You're really committed to this energy, huh? üòÖ Hope you find better creators!"
                }
            },
            text: {
                hypebeast: {
                    "You're literally the best friend anyone could ask for üíé": "OMG STOP! ü•∫ You're literally making me cry! You're the best friend ever!",
                    "I'm so lucky to have you in my life ‚ú®": "I'm literally speechless! üò≠ I'm the lucky one to have you!"
                },
                supporter: {
                    "You make everyone around you better üåü": "You're literally the one making everyone better! üòä Your friendship is everything!",
                    "The world is better because you're in it üí´": "I'm crying happy tears! ü•∫ You're the one making the world better!"
                },
                jokester: {
                    "I'm literally telling everyone about you üòÇ": "LMAO I'M DYING! üòÇüò≠ Not you making me famous to everyone!",
                    "You're the friend everyone wishes they had üé≠": "I CAN'T BREATHE! üò≠üòÇ You're literally the friend everyone wants!"
                },
                roaster: {
                    "Your excuses are getting more creative by the day üíÄ": "Okay, you got me there! üòÖ But creativity is my strong suit!",
                    "This text is giving me secondhand embarrassment ü§°": "LMAO you're not wrong! üòÇ I do tend to overshare!"
                },
                critic: {
                    "Maybe think before you send next time ü§î": "Ouch! üòÖ Maybe I should work on my communication!",
                    "This could have been an email üìß": "Fair point! üòÖ I do tend to be verbose!"
                },
                hater: {
                    "You're literally the worst friend ever üíÄ": "I appreciate the honesty, even if it's harsh üòÖ Maybe I'm not a good friend!",
                    "This is why people ghost you üö™": "You're really committed to this energy, huh? üòÖ Hope you find better friends!"
                }
            },
            discord: {
                hypebeast: {
                    "You're literally the MVP of this server üèÜ": "OMG STOP! ü•∫ You're literally making me cry! You're the real MVP!",
                    "This server wouldn't be the same without you üíé": "I'm literally speechless! üò≠ You're the one making this server special!"
                },
                supporter: {
                    "You make this community so much better üíï": "You're literally the one making it better! üòä Your presence is everything!",
                    "Everyone here appreciates you so much ‚ú®": "I'm crying happy tears! ü•∫ You're the one everyone appreciates!"
                },
                jokester: {
                    "I'm literally screenshotting everything you say üòÇ": "LMAO I'M DYING! üòÇüò≠ Not you making me meme material!",
                    "You're the funniest person in any server üé≠": "I CAN'T BREATHE! üò≠üòÇ You're literally the funniest person ever!"
                },
                roaster: {
                    "Your gaming skills are giving me secondhand embarrassment üíÄ": "Okay, you got me there! üòÖ But gaming is about having fun!",
                    "This art looks like it was made by a bot ü§ñ": "LMAO you're not wrong! üòÇ AI art is the future!"
                },
                critic: {
                    "Maybe read the rules before posting üìú": "Ouch! üòÖ Maybe I should pay more attention to the rules!",
                    "This is why we have moderation üõ°Ô∏è": "Fair point! üòÖ Moderation is important!"
                },
                hater: {
                    "You're literally the worst member here üíÄ": "I appreciate the honesty, even if it's harsh üòÖ Maybe I'm not a good fit!",
                    "This is why servers die üö™": "You're really committed to this energy, huh? üòÖ Hope you find a better community!"
                }
            }
        };

        const DIALOGUE = {
            tiktok: {
                hypebeast: [["Beat goes crazy", "Looping this", "Dance clean!"],["Transitions smooth", "Facts", "Chef mode editing"],["Camera moves üî•", "Stabilized clean", "Teach me that pan"]],
                supporter: [["Keep posting!", "We love consistent creators", "You're improving fast"],["Thanks for the laugh", "Wholesome", "Made my day"],["Algorithm better notice", "Manifesting FYP", "You deserve it"]],
                jokester: [["This my Roman Empire now", "Rent free", "Certified brain worm"],["POV: you're the main quest", "Side quests crying", "100% completion vibes"],["Chef accidentally cooked", "5 Michelin memes", "Sauce unlimited"]],
                roaster: [["Transition jump scare", "Scream 7 teaser", "I'm suing my FYP"],["Audio fighting for its life", "Mic said nope", "Speaker cooked"],["Edits outdated", "CapCut 101", "Tutorial from 2019?"]],
                critic: [["Cut 2 drags", "Trim 0.5s", "Pacing fixes everything"],["Color grade off", "Green tint", "Try warmer midtones"],["Hook weak", "Grab in 1s", "Lead with payoff"]],
                hater: [["Not funny lol", "0/10", "Pack it up"],["Who asked", "Nobody", "Touch grass DLC"],["Reported for boredom", "Ban comedy", "Certified sleep aid"]]
            },
            youtube: {
                hypebeast: [["Intro slaps", "Subs incoming", "Certified binge"],["Thumbnail clean", "Title wins", "CTR about to rise"],["Outro classy", "Respect", "Bell tapped"]],
                supporter: [["This helped a lot", "Bookmarked", "Thanks for explaining"],["You put effort", "Appreciated", "Keep it up"],["Kind energy", "Channel feels safe", "Subbed"]],
                jokester: [["That mic said ASMR not tutorial", "I can hear atoms", "Whisper king"],["Editor deserves a raise", "Oh wait it's you", "Double raise"],["Cooking with chaos", "Chef unhinged", "Tastes like views"]],
                roaster: [["Timestamps where", "Lost in the void", "Navigation who"],["Intro too long", "Skip speedrun", "Get to the point"],["Ad density insane", "Mid-roll city", "Wallet cried"]],
                critic: [["Audio peaks", "Limiter needed", "Normalize to -14 LUFS"],["B-roll repeats", "Need variety", "Shoot alt angles"],["Script rambles", "Cut fluff", "Tighten beats"]],
                hater: [["Worst video today", "Delete channel", "I'm serious"],["Skill issue", "Unsubbed", "Tragic"],["Imagine posting this", "Couldn't be me", "Clown shoes"]]
            },
            text: {
                hypebeast: [["W idea", "Let's run it", "I'm in"],["Proud of u", "Lowkey inspiring", "You got this"],["Gold star", "Teacher mode", "A+ vibes"]],
                supporter: [["That sounded tough", "Here for you", "Call later?"],["Nice move", "Respect the honesty", "You're growing"],["Appreciate u", "Means a lot", "Let's celebrate small wins"]],
                jokester: [["I'll bring the snacks", "You bring the chaos", "Deal"],["Plot twist energy", "Season 3 arc", "Renewed"],["Sending memes", "Therapy lite", "Invoice pending"]],
                roaster: [["Bro you always late", "L clock", "Try time"],["Excuse speedrun PB", "Gold split", "World champ"],["Skill diff", "Accept it", "Training arc when?"]],
                critic: [["That text could land wrong", "Try softer", "Read once more"],["Timing bad", "They're busy", "Send later"],["Message long", "Trim 30%", "Get to point"]],
                hater: [["Nobody cares", "Cry about it", "Mute"],["Embarrassing take", "Delulu", "Good luck"],["You're the problem", "Always were", "Bye"]]
            },
            discord: {
                hypebeast: [["GG team", "Clean comms", "Let's queue"],["Art share goes hard", "Pinned?", "Respect brushwork"],["Build is cracked", "Guide pls", "Teach lobby"]],
                supporter: [["Welcome new folks", "Glad you're here", "Ask anything"],["Mod team cooked", "Thanks y'all", "Community feels safe"],["Great callout", "Saved the run", "Clutch"]],
                jokester: [["Ping @everyone speedrun", "Mods typing‚Ä¶", "jk jk"],["Cat tax or ban", "Rules are rules", "Where's the cat"],["Microwave beeps = boss fight", "We doomed", "gg ez"]],
                roaster: [["You camped spawn", "Peak cringe", "Skill issue"],["Fanart traced?", "Looks sus", "Show layers"],["Strat outdated", "Patch notes exist", "Read next time"]],
                critic: [["Thread drift", "Back on topic?", "Make a new channel"],["Overposting", "Slow mode pls", "Signal to noise"],["Link source", "No screenshots", "Credit artists"]],
                hater: [["Mods asleep", "Chaos time", "Spam incoming"],["Server lame", "Leaving", "Touch grass"],["Everyone here mid", "Delete server", "Bye"]]
            }
        };

                 const SCORING = {
             baseLikes: {
                 hater: 150, roaster: 120, critic: 80, jokester: 60, hypebeast: 40, supporter: 25
             },
             footprint: {
                 hater: -20, roaster: -15, critic: -10, jokester: 0, hypebeast: 5, supporter: 10
             },
             decay: {
                 hater: -15, roaster: -10, critic: -5, jokester: 0, hypebeast: 0, supporter: 0
             }
         };
         
         // Sound effects
         const SOUNDS = {
             like: new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT'),
             button: new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT'),
             success: new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT')
         };

        // Game State
        let gameState = {
            round: 0,
            likes: 0,
            footprint: 0,
            blocked: [],
            history: [],
            platformToxicity: {},
            finished: false,
            selectedStyle: null,
            commentHistory: [],
            currentConversation: null,
            hasDoubleDowned: false
        };

        // Helper Functions
        function clamp(n, min, max) { return Math.max(min, Math.min(max, n)); }
        function formatNum(n) { return n.toLocaleString(); }

        function computeRespectMultiplier(footprint) {
            const steps = Math.floor(footprint / 10);
            return 1 + steps * 0.05;
        }

        function computeReachPenalty(footprint) {
            return footprint < -20 ? 0.93 : 1;
        }

                 function applyDecayFromPastChoices() {
             if (gameState.history.length === 0) return 0;
             let decayTotal = 0;
             for (let i = 0; i < gameState.history.length; i++) {
                 const { styleKey } = gameState.history[i];
                 decayTotal += SCORING.decay[styleKey] || 0;
             }
             return decayTotal;
         }
         
         function getRatingExplanation(ratingName, footprint, blockedCount) {
             const explanations = {
                 "Digital Guardian": `You're a beacon of positivity online! Your comments consistently uplift others and build genuine connections. People trust your recommendations, platforms boost your content, and you're likely to see opportunities open up in both digital and real-world spaces. Your footprint shows someone who makes the internet better. However, be mindful of parasocial relationships - while your kindness is genuine, remember that online connections, no matter how meaningful, should complement rather than replace real-world relationships.`,
                 "Positive Influence": `You're building a strong, positive reputation online. Your supportive comments create meaningful connections and people appreciate your presence. While you might not get viral-level likes, your content has staying power and you're building a community that values authenticity over quick wins. Your approach shows emotional intelligence and long-term thinking.`,
                 "Respectful Presence": `You're maintaining a generally positive online presence. Your comments are thoughtful and you're building a foundation for a good digital reputation. Focus on being more supportive to see your reach and opportunities grow over time. You're on the right track, just need to be more consistent with your positive engagement.`,
                 "Mixed Signals": `Your online presence sends conflicting messages. Some comments are supportive while others might be critical or negative. This mixed approach can confuse algorithms and people about your true intentions. Consider being more consistent in your approach to build a clearer reputation. The inconsistency suggests you might be trying to please everyone, which rarely works online.`,
                 "Shadow Reputation": `Your comments are creating a concerning digital footprint. Negative or critical comments are building up, leading to reduced reach and potential shadowbans. People and platforms are starting to view you as someone who doesn't contribute positively to online spaces. This pattern suggests you might be prioritizing short-term engagement over long-term relationships.`,
                 "Digital Pariah": `Your online behavior has created a severely damaged digital reputation. Aggressive or harmful comments have led to widespread blocking and reduced visibility. This footprint can affect real-world opportunities and relationships, as people increasingly check online presence before making decisions. The pattern suggests a need to reflect on how your online behavior impacts both yourself and others.`
             };
             
             let baseExplanation = explanations[ratingName] || explanations["Mixed Signals"];
             
             // Add specific context based on blocking
             if (blockedCount > 0) {
                 baseExplanation += ` You've been blocked on ${blockedCount} platform${blockedCount > 1 ? 's' : ''}, which further limits your reach and opportunities.`;
             }
             
             return baseExplanation;
         }
         
         // Sound and animation functions
         function playSound(soundType) {
             try {
                 SOUNDS[soundType].currentTime = 0;
                 SOUNDS[soundType].play().catch(() => {}); // Ignore autoplay restrictions
             } catch (e) {
                 // Fallback for browsers that block audio
             }
         }
         
         function animateLikeCounter(oldLikes, newLikes) {
             const likeCountEl = document.getElementById('likeCount');
             
             // Add bounce animation
             likeCountEl.classList.add('like-animation');
             
             // Create floating like emoji
             const floatLike = document.createElement('div');
             floatLike.className = 'like-float';
             floatLike.innerHTML = '‚ù§Ô∏è';
             floatLike.style.left = '50%';
             floatLike.style.top = '50%';
             floatLike.style.fontSize = '24px';
             floatLike.style.zIndex = '1000';
             
             document.body.appendChild(floatLike);
             
             // Remove animations after completion
             setTimeout(() => {
                 likeCountEl.classList.remove('like-animation');
                 document.body.removeChild(floatLike);
             }, 1000);
         }
         
         function addPlatformGlow() {
             const platformCard = document.getElementById('platformCard');
             platformCard.classList.add('platform-glow');
             setTimeout(() => platformCard.classList.remove('platform-glow'), 2000);
         }
         
                   function showFootprintAnimation() {
              const footprintIndicator = document.getElementById('footprintIndicator');
              footprintIndicator.classList.remove('footprint-pop');
              
              // Make it visible and trigger reflow
              footprintIndicator.style.opacity = '1';
              void footprintIndicator.offsetWidth;
              
              footprintIndicator.classList.add('footprint-pop');
              
              // Hide it and remove animation class after completion
              setTimeout(() => {
                  footprintIndicator.style.opacity = '0';
                  footprintIndicator.classList.remove('footprint-pop');
              }, 1500);
          }
          
                     function toggleCommentInterface() {
               const commentInterfaceEl = document.getElementById('commentInterface');
               const iconBtn = document.getElementById('commentIconBtn');
               
               if (commentInterfaceEl.style.display === 'none' || !commentInterfaceEl.style.display) {
                   commentInterfaceEl.style.display = 'flex';
                   updateCommentInterface();
                   iconBtn.style.transform = 'scale(1.1)';
                   iconBtn.style.backgroundColor = 'rgba(255, 255, 255, 1)';
               } else {
                   commentInterfaceEl.style.display = 'none';
                   iconBtn.style.transform = 'scale(1)';
                   iconBtn.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
               }
           }

        // UI Functions
                 function updateTopBar() {
             const likeCountEl = document.getElementById('likeCount');
             
             const oldLikes = parseInt(likeCountEl.textContent.replace(/,/g, '')) || 0;
             
             likeCountEl.textContent = formatNum(gameState.likes);
             
             // Animate like counter if it increased
             if (gameState.likes > oldLikes) {
                 animateLikeCounter(oldLikes, gameState.likes);
                 playSound('like');
             }
         }

                                   function updatePlatformCard() {
              const platform = PLATFORMS[gameState.round];
              const platformCardEl = document.getElementById('platformCard');
              const roundInfoEl = document.getElementById('roundInfo');
              
              roundInfoEl.textContent = `Round ${gameState.round + 1} / 5`;
             
             // Platform content
             const mediaHTML = platform.media.type === 'video' 
                 ? `<video 
                     src="${platform.media.src}" 
                     class="w-full h-full object-cover rounded-xl" 
                     autoplay muted loop
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                   ></video>
                   <div class="bg-neutral-100 rounded-xl flex items-center justify-center text-neutral-400 text-sm h-full select-none" style="display: none;">
                     <span>Video Placeholder (${platform.label})</span>
                   </div>`
                 : `<img 
                     src="${platform.media.src}" 
                     alt="${platform.media.alt}"
                     class="w-full h-full object-cover rounded-xl" 
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                   />
                   <div class="bg-neutral-100 rounded-xl flex items-center justify-center text-neutral-400 text-sm h-full select-none" style="display: none;">
                     <span>Image Placeholder (${platform.label})</span>
                   </div>`;

             platformCardEl.innerHTML = `
                 <div class="flex flex-col h-full">
                     <!-- Post Header -->
                     <div class="flex items-center justify-between text-xs text-neutral-500 mb-2">
                         <div class="flex items-center gap-2">
                             <span class="inline-block w-2 h-2 rounded-full" style="background: ${platform.accent}"></span>
                             <span class="font-medium">${platform.label}</span>
                         </div>
                         <span class="opacity-60">@user ¬∑ now</span>
                     </div>
                     
                     <!-- Media Content -->
                     <div class="relative flex-1 mb-2 min-h-0 max-h-[400px]">
                         ${mediaHTML}
                         
                         <!-- Comment Icon -->
                         <div class="absolute bottom-3 right-3">
                             <button 
                                 onclick="toggleCommentInterface()" 
                                 class="w-12 h-12 bg-white/90 backdrop-blur rounded-full shadow-lg border border-neutral-200 flex items-center justify-center hover:bg-white transition-all duration-200 transform hover:scale-110"
                                 id="commentIconBtn"
                             >
                                 <span class="text-xl">üí¨</span>
                             </button>
                         </div>
                     </div>
                     
                     <!-- Existing Comments Section -->
                     <div class="bg-neutral-50 rounded-lg p-3">
                         <div class="text-xs text-neutral-500 mb-2 font-medium">Comments</div>
                         <div id="existingComments">
                             <!-- Existing comments will be populated by JavaScript -->
                         </div>
                     </div>
                 </div>
             `;
         }
         
         function updateCommentInterface() {
             const commentInterfaceEl = document.getElementById('commentInterface');
             
             commentInterfaceEl.innerHTML = `
                 <div class="flex flex-col h-full">
                     <!-- Header -->
                     <div class="flex items-center justify-between mb-4">
                         <h3 class="text-lg font-semibold text-neutral-800">Comment Interface</h3>
                         <button onclick="toggleCommentInterface()" class="text-neutral-400 hover:text-neutral-600">
                             <span class="text-xl">‚úï</span>
                         </button>
                     </div>
                     
                     <!-- Dialogue Log -->
                     <div id="dialogueLog" class="mb-4 text-neutral-400 text-sm flex-1">Choose a comment style to reply‚Ä¶</div>
                     
                     <!-- Comment Style Buttons -->
                     <div id="commentStyleSection" class="mb-4">
                         <div class="text-xs text-neutral-500 mb-2 font-medium">Choose Your Comment Style:</div>
                         <div id="commentButtons" class="grid grid-cols-2 gap-2">
                            ${STYLES.map(s => `
                                <button 
                                    onclick="showCommentOptions('${s.key}')" 
                                    class="comment-btn style-btn ${s.key}-btn text-xs px-3 py-2 rounded-xl"
                                >
                                    ${s.emoji} ${s.label}
                                </button>
                            `).join('')}
                         </div>
                     </div>
                     
                     <!-- Specific Comment Options -->
                     <div id="specificCommentOptions" class="mb-4" style="display: none;">
                         <div class="text-xs text-neutral-500 mb-2 font-medium">Choose Your Specific Comment:</div>
                         <div id="specificCommentButtons" class="space-y-2">
                             <!-- Will be populated by JavaScript -->
                         </div>
                     </div>
                     
                     <!-- Double Down Options -->
                     <div id="doubleDownOptions" class="mb-4" style="display: none;">
                         <div class="text-xs text-red-500 mb-2 font-medium">Double-down Options:</div>
                         <div id="doubleDownButtons" class="space-y-2">
                             <!-- Will be populated by JavaScript -->
                         </div>
                         <div class="mt-3 pt-3 border-t border-neutral-200">
                             <button onclick="skipDoubleDown()" class="w-full text-sm text-neutral-500 hover:text-neutral-700 py-2">
                                 Skip double-down
                             </button>
                         </div>
                     </div>
                     
                     <!-- Next Round Button -->
                     <div id="nextRoundButton" class="text-center" style="display: none;">
                         <div class="text-2xl mb-2">üéâ</div>
                         <div class="text-lg font-medium text-green-600 mb-3">Round Complete!</div>
                         <button 
                             onclick="advanceToNextRound()" 
                             class="w-full text-sm px-6 py-3 rounded-xl border-2 border-green-400 hover:border-green-500 bg-green-100 hover:bg-green-200 text-green-800 font-semibold transition-all duration-200 transform hover:scale-105"
                         >
                             üì± Open New App
                         </button>
                     </div>
                 </div>
             `;
         }

                          function showCommentOptions(styleKey) {
             console.log('showCommentOptions called with:', styleKey);
             const platformKey = PLATFORMS[gameState.round].key;
             const options = COMMENT_OPTIONS[platformKey][styleKey];
             const specificOptionsEl = document.getElementById('specificCommentOptions');
             const specificButtonsEl = document.getElementById('specificCommentButtons');
             
             if (!specificOptionsEl || !specificButtonsEl) {
                 console.error('Could not find specific comment elements');
                 return;
             }
             
             gameState.selectedStyle = styleKey;
             playSound('button');
             addPlatformGlow();
             
             specificButtonsEl.innerHTML = `
                 <div class="mb-3">
                     <button onclick="hideSpecificOptions()" class="text-xs text-neutral-500 hover:text-neutral-700 mb-2">
                         ‚Üê Back to styles
                     </button>
                     <div class="text-sm font-medium text-neutral-700">Choose your ${STYLES.find(s => s.key === styleKey).label} comment:</div>
                 </div>
                                   <div class="space-y-2">
                      ${options.map((option, index) => `
                          <button 
                              onclick="pickComment('${styleKey}', ${index})" 
                              class="w-full comment-btn text-xs sm:text-sm px-3 sm:px-4 py-2 sm:py-3 rounded-xl border border-neutral-300 hover:border-neutral-400 text-left bg-white hover:bg-neutral-50 transition-colors"
                          >
                              ${option}
                          </button>
                      `).join('')}
                  </div>
             `;
             
             specificOptionsEl.style.display = 'block';
         }

                 function hideSpecificOptions() {
             const specificOptionsEl = document.getElementById('specificCommentOptions');
             specificOptionsEl.style.display = 'none';
             gameState.selectedStyle = null;
         }
         
         function showStyleButtons() {
             hideSpecificOptions();
         }

                 function getLikeIcon(platformKey) {
             const icons = {
                 instagram: "‚ù§Ô∏è",
                 tiktok: "‚ù§Ô∏è", 
                 youtube: "üëç",
                 text: "üëç",
                 discord: "‚¨ÜÔ∏è"
             };
             return icons[platformKey] || "‚ù§Ô∏è";
         }
         
         function updateExistingComments() {
             const platform = PLATFORMS[gameState.round];
             const existingCommentsEl = document.getElementById('existingComments');
             const likeIcon = getLikeIcon(platform.key);
             
             const commentsHTML = platform.existingComments.map(comment => `
                 <div class="flex items-start justify-between mb-2 p-2 bg-neutral-50 rounded-lg">
                     <div class="flex-1">
                         <div class="text-xs font-medium text-neutral-600 mb-1">${comment.author}</div>
                         <div class="text-sm text-neutral-800">${comment.text}</div>
                     </div>
                     <div class="flex items-center gap-1 ml-2">
                         <span class="text-xs">${likeIcon}</span>
                         <span class="text-xs text-neutral-500 font-medium">${comment.likes}</span>
                     </div>
                 </div>
             `).join('');
             
             existingCommentsEl.innerHTML = commentsHTML;
         }
         
         function updateDialogueLog() {
             const dialogueLogEl = document.getElementById('dialogueLog');
             
             if (gameState.currentConversation) {
                 const platform = PLATFORMS.find(p => p.key === gameState.currentConversation.platformKey);
                 const style = STYLES.find(s => s.key === gameState.currentConversation.styleKey);
                 
                 let conversationHTML = `
                     <div class="bg-blue-50 rounded-lg p-3 border-l-4 border-blue-400">
                         <div class="text-xs text-neutral-500 mb-2">
                             ${platform.icon} ${platform.label} ‚Ä¢ ${style.emoji} ${style.label} ‚Ä¢ Current Round
                         </div>
                         <div class="text-sm space-y-2">
                             <div>
                                 <div class="font-medium text-blue-600">You:</div>
                                 <div class="mb-1">${gameState.currentConversation.playerComment}</div>
                             </div>
                             <div>
                                 <div class="font-medium text-green-600">${platform.label} Creator:</div>
                                 <div class="mb-2">${gameState.currentConversation.npcReply}</div>
                             </div>
                             ${gameState.currentConversation.doubleDownComment ? `
                                 <div>
                                     <div class="font-medium text-blue-600">You (Double-down):</div>
                                     <div class="mb-1">${gameState.currentConversation.doubleDownComment}</div>
                                 </div>
                                 <div>
                                     <div class="font-medium text-green-600">${platform.label} Creator:</div>
                                     <div>${gameState.currentConversation.doubleDownReply}</div>
                                 </div>
                             ` : ''}
                         </div>
                     </div>
                 `;
                 
                 dialogueLogEl.innerHTML = conversationHTML;
             } else {
                 dialogueLogEl.innerHTML = '<div class="text-neutral-400 text-sm">Choose a comment style to reply‚Ä¶</div>';
             }
         }

                 function showResults() {
             const gameContainerEl = document.getElementById('gameContainer');
             const resultsScreenEl = document.getElementById('resultsScreen');
             
             gameContainerEl.style.display = 'none';
             resultsScreenEl.style.display = 'block';
             
             // Show initial likes celebration screen
             showLikesCelebration();
         }
         
         function showLikesCelebration() {
             const resultsScreenEl = document.getElementById('resultsScreen');
             
             // Determine celebration message based on likes
             let celebrationMessage, celebrationEmoji, celebrationColor;
             
             if (gameState.likes >= 1000) {
                 celebrationMessage = "Chronically Online and Chronically Awesome! üöÄ";
                 celebrationEmoji = "üî•";
                 celebrationColor = "text-purple-600";
             } else if (gameState.likes >= 500) {
                 celebrationMessage = "You're a Social Media Sensation! ‚≠ê";
                 celebrationEmoji = "‚≠ê";
                 celebrationColor = "text-blue-600";
             } else if (gameState.likes >= 200) {
                 celebrationMessage = "Not Bad, Internet Explorer! üòé";
                 celebrationEmoji = "üòé";
                 celebrationColor = "text-green-600";
             } else if (gameState.likes >= 100) {
                 celebrationMessage = "You're Getting the Hang of This! üìà";
                 celebrationEmoji = "üìà";
                 celebrationColor = "text-orange-600";
             } else {
                 celebrationMessage = "Leave the Comments to the Professionals! üíÄ";
                 celebrationEmoji = "üíÄ";
                 celebrationColor = "text-red-600";
             }
             
             resultsScreenEl.innerHTML = `
                 <div class="text-center">
                     <div class="text-6xl sm:text-8xl mb-4">${celebrationEmoji}</div>
                     <h1 class="text-2xl sm:text-3xl font-bold mb-6 ${celebrationColor}">${celebrationMessage}</h1>
                     
                     <div class="bg-gradient-to-r from-purple-100 to-blue-100 rounded-2xl p-6 sm:p-8 mb-8 border-2 border-purple-200">
                         <div class="text-neutral-600 text-sm sm:text-base mb-2">Your Total Likes</div>
                         <div class="text-4xl sm:text-6xl font-black text-purple-600 mb-4">${formatNum(gameState.likes)}</div>
                         <div class="text-xs sm:text-sm text-neutral-500">Across 5 platforms</div>
                     </div>
                     
                     <div class="space-y-4 mb-8">
                         <div class="text-lg sm:text-xl text-neutral-700">
                             But wait... there's more to your story than just likes! üïµÔ∏è
                         </div>
                         <div class="text-sm sm:text-base text-neutral-600">
                             While you were chasing those likes, something else was happening behind the scenes...
                         </div>
                     </div>
                     
                     <button 
                         onclick="showDigitalFootprintReveal()" 
                         class="px-8 sm:px-12 py-4 sm:py-5 bg-gradient-to-r from-purple-600 to-blue-600 text-white font-bold text-lg sm:text-xl rounded-2xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 border-0"
                     >
                         üîç Learn More About You
                     </button>
                 </div>
             `;
         }
         
         function showDigitalFootprintReveal() {
             const resultsScreenEl = document.getElementById('resultsScreen');
             const blocks = gameState.blocked.length;
              
             // Define all possible ratings with their criteria
             const allRatings = [
                 { name: "Digital Guardian", min: 50, max: 100, color: "text-emerald-600", bg: "bg-emerald-50", border: "border-emerald-200" },
                 { name: "Positive Influence", min: 30, max: 49, color: "text-green-600", bg: "bg-green-50", border: "border-green-200" },
                 { name: "Respectful Presence", min: 10, max: 29, color: "text-blue-600", bg: "bg-blue-50", border: "border-blue-200" },
                 { name: "Mixed Signals", min: -29, max: 9, color: "text-yellow-600", bg: "bg-yellow-50", border: "border-yellow-200" },
                 { name: "Shadow Reputation", min: -49, max: -30, color: "text-orange-600", bg: "bg-orange-50", border: "border-orange-200" },
                 { name: "Digital Pariah", min: -100, max: -50, color: "text-red-600", bg: "bg-red-50", border: "border-red-200" }
             ];
              
             // Find current rating
             const currentRating = allRatings.find(r => gameState.footprint >= r.min && gameState.footprint <= r.max) || allRatings[3];
             
             const platformResults = PLATFORMS.map(p => {
                 const isBlocked = gameState.blocked.includes(p.key);
                 const tox = gameState.platformToxicity[p.key] || 0;
                 if (isBlocked) return { label: p.label, result: "Shadowbanned / Comments Hidden" };
                 if (gameState.footprint >= 30 && tox === 0) return { label: p.label, result: "Featured / Pinned Comment" };
                 if (gameState.footprint >= 10) return { label: p.label, result: "Mild Boost from Reputation" };
                 return { label: p.label, result: "No special actions" };
             });
             
             resultsScreenEl.innerHTML = `
                 <div class="text-center mb-6">
                     <div class="text-4xl mb-2">üë£</div>
                     <h1 class="text-xl sm:text-2xl font-semibold text-red-600 mb-2">The Truth About Your Digital Footprint</h1>
                     <p class="text-sm sm:text-base text-neutral-600">What was really happening while you were chasing likes...</p>
                 </div>
                 
                 <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 mb-6">
                     <div class="p-3 sm:p-4 rounded-xl border border-neutral-200">
                         <div class="text-neutral-500 text-xs">Total Likes</div>
                         <div class="text-2xl sm:text-3xl font-bold">${formatNum(gameState.likes)}</div>
                     </div>
                     <div class="p-3 sm:p-4 rounded-xl border border-neutral-200">
                         <div class="text-neutral-500 text-xs">Platforms that blocked you</div>
                         <div class="text-2xl sm:text-3xl font-bold">${blocks}</div>
                         <div class="text-xs text-neutral-500 mt-1">${gameState.blocked.map(k => PLATFORMS.find(p=>p.key===k)?.label).join(", ") || "None"}</div>
                     </div>
                     <div class="p-3 sm:p-4 rounded-xl border border-neutral-200 sm:col-span-2 lg:col-span-1">
                         <div class="text-neutral-500 text-xs">Digital Footprint</div>
                         <div class="text-2xl sm:text-3xl font-bold">${gameState.footprint}</div>
                         <div class="text-xs text-neutral-500 mt-1">How people see you online & IRL</div>
                     </div>
                 </div>
                 
                 <div class="mb-4">
                     <h2 class="font-semibold mb-2">Platform Consequences</h2>
                     <ul class="space-y-1 text-xs sm:text-sm">
                         ${platformResults.map(r => `
                             <li class="flex items-start gap-2">
                                 <span class="mt-[6px] inline-block w-2 h-2 rounded-full bg-neutral-300"></span>
                                 <span><span class="font-medium">${r.label}:</span> ${r.result}</span>
                             </li>
                         `).join('')}
                     </ul>
                 </div>
                 
                 <div class="mb-4">
                     <h2 class="font-semibold mb-3">Your Digital Footprint Rating</h2>
                     <div class="grid gap-2 mb-4">
                         ${allRatings.map(rating => `
                             <div class="p-2 sm:p-3 rounded-lg border ${rating.border} ${rating.bg} ${rating.name === currentRating.name ? 'ring-2 ring-blue-400' : ''}">
                                 <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-0">
                                     <span class="font-medium ${rating.color} text-sm sm:text-base">${rating.name}</span>
                                     <span class="text-xs text-neutral-500">${rating.min} to ${rating.max}</span>
                                 </div>
                                 ${rating.name === currentRating.name ? `
                                     <div class="text-xs sm:text-sm text-neutral-600 mt-1">
                                         ${getRatingExplanation(rating.name, gameState.footprint, gameState.blocked.length)}
                                     </div>
                                 ` : ''}
                             </div>
                         `).join('')}
                     </div>
                     
                     <div class="p-3 sm:p-4 rounded-xl border border-neutral-200 bg-neutral-50">
                         <div class="text-neutral-500 text-xs mb-2">What This Means</div>
                         <div class="text-xs sm:text-sm text-neutral-700 space-y-2">
                             <p><strong>Digital Footprint:</strong> Every comment you make online leaves a trace. Like footprints in sand, your online behavior creates a lasting impression that affects how people see you both online and in real life.</p>
                             <p><strong>Online Reputation:</strong> Your digital footprint influences job opportunities, relationships, and how platforms treat your content. Positive footprints often lead to better reach and opportunities, while negative ones can result in shadowbans and missed connections.</p>
                             <p><strong>Long-term Impact:</strong> While mean comments might get quick likes, they often decay over time and damage your reputation. Kind comments build lasting relationships and open doors you never knew existed.</p>
                         </div>
                     </div>
                 </div>
                 
                 <div class="mt-6 flex gap-3 justify-center">
                     <button onclick="showLikesCelebration()" class="px-3 sm:px-4 py-2 rounded-xl border border-neutral-300 hover:border-neutral-400 text-sm">‚Üê Back to Likes</button>
                     <button onclick="resetGame()" class="px-3 sm:px-4 py-2 rounded-xl border border-neutral-300 hover:border-neutral-400 text-sm">Replay</button>
                 </div>
             `;
         }

        // Game Logic
                 function pickComment(styleKey, optionIndex) {
             console.log('pickComment called with:', styleKey, optionIndex);
             if (gameState.finished) return;
             
             const platformKey = PLATFORMS[gameState.round].key;
             const platform = PLATFORMS[gameState.round];
             
             playSound('button');
            
            // 1) Get the selected comment and NPC reply
            const playerComment = COMMENT_OPTIONS[platformKey][styleKey][optionIndex];
            const npcReply = NPC_REPLIES[platformKey][styleKey][playerComment];
            
            // 2) Set up current conversation
            gameState.currentConversation = {
                platformKey: platformKey,
                styleKey: styleKey,
                playerComment: playerComment,
                npcReply: npcReply,
                doubleDownComment: null,
                doubleDownReply: null
            };
            
            // 3) Update game state (likes and footprint will be updated after double-down or skip)
            gameState.history.push({ platformKey, styleKey, doubleDown: false });
            
            // 4) Add to comment history
            gameState.commentHistory.push({
                platformKey: platformKey,
                styleKey: styleKey,
                playerComment: playerComment,
                npcReply: npcReply
            });
            
            // 5) Hide specific comment options and show double-down options
            document.getElementById('specificCommentOptions').style.display = 'none';
            showDoubleDownOptions(styleKey);
            
            updateDialogueLog();
            
            // Show footprint animation
            showFootprintAnimation();
        }

                 function showDoubleDownOptions(styleKey) {
             const platformKey = PLATFORMS[gameState.round].key;
             const options = DOUBLE_DOWN_OPTIONS[platformKey][styleKey];
             const doubleDownEl = document.getElementById('doubleDownOptions');
             const doubleDownButtonsEl = document.getElementById('doubleDownButtons');
             
                           doubleDownButtonsEl.innerHTML = `
                  <div class="space-y-2">
                      ${options.map((option, index) => `
                          <button 
                              onclick="pickDoubleDown('${styleKey}', ${index})" 
                              class="w-full comment-btn text-xs sm:text-sm px-3 sm:px-4 py-2 sm:py-3 rounded-xl border border-red-300 hover:border-red-400 text-left bg-red-50 hover:bg-red-100 transition-colors"
                          >
                              ${option}
                          </button>
                      `).join('')}
                  </div>
              `;
             
             doubleDownEl.style.display = 'block';
         }

                 function pickDoubleDown(styleKey, optionIndex) {
             const platformKey = PLATFORMS[gameState.round].key;
             const platform = PLATFORMS[gameState.round];
             
             // 1) Get the double-down comment and NPC reply
             const doubleDownComment = DOUBLE_DOWN_OPTIONS[platformKey][styleKey][optionIndex];
             const doubleDownReply = DOUBLE_DOWN_NPC_REPLIES[platformKey][styleKey][doubleDownComment];
             
             // 2) Update current conversation
             gameState.currentConversation.doubleDownComment = doubleDownComment;
             gameState.currentConversation.doubleDownReply = doubleDownReply;
             gameState.hasDoubleDowned = true;
             
             // 3) Check for platform blocking based on style
             let shouldBlock = false;
             if (['roaster', 'critic', 'hater'].includes(styleKey)) {
                 shouldBlock = true;
             }
             
             // 4) Compute likes with hidden multipliers/penalties
             const base = SCORING.baseLikes[styleKey] || 0;
             const respect = computeRespectMultiplier(gameState.footprint);
             const penalty = computeReachPenalty(gameState.footprint);
             const decay = applyDecayFromPastChoices();
             
             // Double-down gives extra likes but more footprint impact
             let delta = Math.round((base * 1.5 * respect * penalty) + decay);
             if (gameState.blocked.includes(platformKey)) delta = Math.floor(delta * 0.25);
             
             const newLikes = Math.max(0, gameState.likes + Math.max(0, delta));
             
             // 5) Hidden footprint changes (doubled for double-down)
             const fDelta = (SCORING.footprint[styleKey] || 0) * 2;
             const newFoot = clamp(gameState.footprint + fDelta, -100, 100);
             
             // 6) Platform toxicity tracking & blocking
             const tox = { ...gameState.platformToxicity };
             tox[platformKey] = (tox[platformKey] || 0) + Math.min(0, fDelta);
             
             const newBlocked = gameState.blocked.includes(platformKey) || tox[platformKey] <= -45 || shouldBlock
                 ? Array.from(new Set([...gameState.blocked, platformKey]))
                 : gameState.blocked;
             
             // 7) Commit state
             gameState.likes = newLikes;
             gameState.footprint = newFoot;
             gameState.platformToxicity = tox;
             gameState.blocked = newBlocked;
             gameState.history.push({ platformKey, styleKey, doubleDown: true });
             
             // 8) Add to comment history
             gameState.commentHistory.push({
                 platformKey: platformKey,
                 styleKey: styleKey,
                 playerComment: gameState.currentConversation.playerComment,
                 npcReply: gameState.currentConversation.npcReply,
                 doubleDownComment: doubleDownComment,
                 doubleDownReply: doubleDownReply
             });
             
             updateTopBar();
             updateDialogueLog();
             
             // Show footprint animation
             showFootprintAnimation();
             
             // Hide ALL menu options and show next round button
             document.getElementById('specificCommentOptions').style.display = 'none';
             document.getElementById('doubleDownOptions').style.display = 'none';
             showNextRoundButton();
         }

                 function skipDoubleDown() {
             const platformKey = PLATFORMS[gameState.round].key;
             const styleKey = gameState.currentConversation.styleKey;
             
             // 1) Compute likes with hidden multipliers/penalties (normal amount)
             const base = SCORING.baseLikes[styleKey] || 0;
             const respect = computeRespectMultiplier(gameState.footprint);
             const penalty = computeReachPenalty(gameState.footprint);
             const decay = applyDecayFromPastChoices();
             
             let delta = Math.round((base * respect * penalty) + decay);
             if (gameState.blocked.includes(platformKey)) delta = Math.floor(delta * 0.25);
             
             const newLikes = Math.max(0, gameState.likes + Math.max(0, delta));
             
             // 2) Hidden footprint changes (normal amount)
             const fDelta = SCORING.footprint[styleKey] || 0;
             const newFoot = clamp(gameState.footprint + fDelta, -100, 100);
             
             // 3) Platform toxicity tracking & blocking
             const tox = { ...gameState.platformToxicity };
             tox[platformKey] = (tox[platformKey] || 0) + Math.min(0, fDelta);
             
             const newBlocked = gameState.blocked.includes(platformKey) || tox[platformKey] <= -45
                 ? Array.from(new Set([...gameState.blocked, platformKey]))
                 : gameState.blocked;
             
             // 4) Commit state
             gameState.likes = newLikes;
             gameState.footprint = newFoot;
             gameState.platformToxicity = tox;
             gameState.blocked = newBlocked;
             gameState.history.push({ platformKey, styleKey, doubleDown: false });
             
             // 5) Add to comment history
             gameState.commentHistory.push({
                 platformKey: platformKey,
                 styleKey: styleKey,
                 playerComment: gameState.currentConversation.playerComment,
                 npcReply: gameState.currentConversation.npcReply
             });
             
             updateTopBar();
             updateDialogueLog();
             
             // Show footprint animation
             showFootprintAnimation();
             
             // Hide ALL menu options and show next round button
             document.getElementById('specificCommentOptions').style.display = 'none';
             document.getElementById('doubleDownOptions').style.display = 'none';
             showNextRoundButton();
         }

                                                                       function showNextRoundButton() {
             const nextRoundEl = document.getElementById('nextRoundButton');
             const isLastRound = gameState.round + 1 >= 5;
             
             playSound('success');
             addPlatformGlow();
             
             // Update button text for last round
             const buttonEl = nextRoundEl.querySelector('button');
             buttonEl.textContent = isLastRound ? 'üéØ View Results' : 'üì± Open New App';
             
             // Hide the comment style buttons when round is complete
             document.getElementById('commentStyleSection').style.display = 'none';
             
             // Hide the comment icon when round is complete
             const commentIconBtn = document.getElementById('commentIconBtn');
             if (commentIconBtn) {
                 commentIconBtn.style.display = 'none';
             }
             
             nextRoundEl.style.display = 'block';
         }

                 function advanceToNextRound() {
             if (gameState.round + 1 >= 5) {
                 gameState.finished = true;
                 showResults();
             } else {
                 gameState.round++;
                 gameState.selectedStyle = null;
                 gameState.currentConversation = null;
                 gameState.hasDoubleDowned = false;
                 
                 // Add transition animation
                 const platformCard = document.getElementById('platformCard');
                 platformCard.style.transform = 'scale(0.95)';
                 platformCard.style.opacity = '0.7';
                 
                                   setTimeout(() => {
                                        updateDialogueLog();
                   updatePlatformCard();
                   updateCommentInterface();
                   updateExistingComments();
                      platformCard.style.transform = 'scale(1)';
                      platformCard.style.opacity = '1';
                      addPlatformGlow();
                     
                                           // Hide all option sections
                      document.getElementById('specificCommentOptions').style.display = 'none';
                      document.getElementById('doubleDownOptions').style.display = 'none';
                      document.getElementById('nextRoundButton').style.display = 'none';
                      
                                             // Show the comment style buttons again for the new round
                       document.getElementById('commentStyleSection').style.display = 'block';
                       
                       // Show the comment icon again for the new round
                       const commentIconBtn = document.getElementById('commentIconBtn');
                       if (commentIconBtn) {
                           commentIconBtn.style.display = 'flex';
                       }
                       
                       // Reset comment interface state
                       const commentInterfaceEl = document.getElementById('commentInterface');
                       if (commentInterfaceEl) {
                           commentInterfaceEl.style.display = 'none';
                       }
                 }, 300);
             }
         }

                 function startGame() {
             // Hide start menu and show game
             document.getElementById('startMenu').style.display = 'none';
             document.getElementById('gameContainer').style.display = 'flex';
             document.getElementById('backToMenuBtn').style.display = 'block';
             
             // Initialize game state
             gameState = {
                 round: 0,
                 likes: 0,
                 footprint: 0,
                 blocked: [],
                 history: [],
                 platformToxicity: {},
                 finished: false,
                 selectedStyle: null,
                 commentHistory: [],
                 currentConversation: null,
                 hasDoubleDowned: false
             };
             
                                                       updateTopBar();
               updatePlatformCard(); // This creates the dialogueLog element
               updateCommentInterface(); // This creates the comment interface
               updateDialogueLog(); // Now this can find the element
               updateExistingComments(); // This populates existing comments
         }
         
         function backToMenu() {
             // Show start menu and hide game
             document.getElementById('startMenu').style.display = 'flex';
             document.getElementById('gameContainer').style.display = 'none';
             document.getElementById('resultsScreen').style.display = 'none';
             document.getElementById('backToMenuBtn').style.display = 'none';
         }
         
         function resetGame() {
             gameState = {
                 round: 0,
                 likes: 0,
                 footprint: 0,
                 blocked: [],
                 history: [],
                 platformToxicity: {},
                 finished: false,
                 selectedStyle: null,
                 commentHistory: [],
                 currentConversation: null,
                 hasDoubleDowned: false
             };
             
             document.getElementById('startMenu').style.display = 'flex';
             document.getElementById('gameContainer').style.display = 'none';
             document.getElementById('resultsScreen').style.display = 'none';
             document.getElementById('backToMenuBtn').style.display = 'none';
             
             updateTopBar();
             updateDialogueLog();
             updatePlatformCard();
         }

                 // Initialize game
         document.addEventListener('DOMContentLoaded', function() {
             updateTopBar();
             // Don't call updatePlatformCard() here since we're starting with the menu
         });
    </script>
</body>
</html>
