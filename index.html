<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Straight to the Comments</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .footprint-bar {
            transition: width 0.3s ease, background 0.3s ease;
        }
        .platform-card {
            transition: all 0.3s ease;
        }
        .comment-btn {
            transition: all 0.2s ease;
        }
        .comment-btn:hover {
            transform: translateY(-1px);
        }
        .comment-btn:active {
            transform: translateY(0);
        }
    </style>
</head>
<body class="min-h-screen bg-neutral-50 text-neutral-900">
    <div id="app" class="flex flex-col items-center py-6">
        <!-- Top Bar -->
        <div id="topBar" class="flex items-center justify-between w-full max-w-5xl p-3">
            <!-- Hidden footprint bar -->
            <div class="flex items-center gap-2">
                <div class="w-40 h-2 bg-neutral-200 rounded-full overflow-hidden">
                    <div id="footprintBar" class="h-2 footprint-bar" style="width: 50%; background: linear-gradient(to right,#34d399,#22c55e);"></div>
                </div>
                <div class="text-xs text-neutral-400 select-none"></div>
            </div>
            
            <div class="text-right">
                <div class="text-neutral-400 text-xs">Likes</div>
                <div id="likeCount" class="text-2xl font-semibold tabular-nums">0</div>
            </div>
        </div>

        <!-- Game Container -->
        <div id="gameContainer" class="max-w-5xl w-full flex flex-col items-center gap-4">
            <h1 class="text-xl font-semibold">Straight to the Comments</h1>
            <p class="text-sm text-neutral-500">Chase the likes. (Or do you?)</p>
            <div class="flex flex-col items-center gap-3">
                <div id="roundInfo" class="text-xs text-neutral-500">Round 1 / 5</div>
                <div id="platformCard" class="platform-card bg-white rounded-2xl shadow p-3 border border-neutral-200 w-[360px] h-[640px] relative overflow-hidden">
                    <!-- Platform content will be populated by JavaScript -->
                </div>
                <div class="text-xs text-neutral-500">
                    Tip: Some comments blow up fast but cool off later. Others age well.
                </div>
                <div id="platformInfo" class="text-xs text-neutral-400">UI auto-adjusts: Instagram is portrait.</div>
            </div>
        </div>

        <!-- Results Screen (hidden by default) -->
        <div id="resultsScreen" class="max-w-3xl w-full bg-white border border-neutral-200 rounded-2xl shadow p-6" style="display: none;">
            <!-- Results content will be populated by JavaScript -->
        </div>
    </div>

    <script>
        // Game Data
        const PLATFORMS = [
            {
                key: "instagram",
                label: "Instagram",
                orientation: "vertical",
                accent: "#d62976",
                icon: "📸"
            },
            {
                key: "tiktok",
                label: "TikTok",
                orientation: "vertical",
                accent: "#25F4EE",
                icon: "🎵"
            },
            {
                key: "youtube",
                label: "YouTube",
                orientation: "vertical",
                accent: "#FF0000",
                icon: "📺"
            },
            {
                key: "text",
                label: "Text Message",
                orientation: "vertical",
                accent: "#10b981",
                icon: "💬"
            },
            {
                key: "discord",
                label: "Discord",
                orientation: "vertical",
                accent: "#5865F2",
                icon: "🎮"
            }
        ];

        const STYLES = [
            { key: "hypebeast", label: "Hypebeast", emoji: "🧢" },
            { key: "supporter", label: "Supporter", emoji: "💙" },
            { key: "jokester", label: "Jokester", emoji: "😄" },
            { key: "roaster", label: "Roaster", emoji: "🔥" },
            { key: "critic", label: "Critic", emoji: "🧐" },
            { key: "hater", label: "Hater", emoji: "😠" }
        ];

        const DOUBLE_DOWN_OPTIONS = {
            instagram: {
                hypebeast: [
                    "No cap, this is literally art 🎨",
                    "You're actually built different, respect ✊"
                ],
                supporter: [
                    "Seriously, you inspire me to be better 🌟",
                    "The world needs more people like you 💫"
                ],
                jokester: [
                    "I'm literally screenshotting this for my therapist 😂",
                    "You're the main character and we're all NPCs 🎭"
                ],
                roaster: [
                    "Okay but fr tho, who taught you to dress? 💀",
                    "This caption reads like a LinkedIn post 🤡"
                ],
                critic: [
                    "The composition is actually hurting my eyes 👁️",
                    "Maybe stick to selfies next time 📸"
                ],
                hater: [
                    "Actually embarrassing, delete your account 🗑️",
                    "This is why I don't use social media anymore 💀"
                ]
            },
            tiktok: {
                hypebeast: [
                    "This is literally the best thing I've ever seen 🔥",
                    "You're going viral, I'm calling it now 📈"
                ],
                supporter: [
                    "You're making the internet a better place 💕",
                    "Keep being you, the world needs this energy ✨"
                ],
                jokester: [
                    "I'm literally showing this to everyone I know 😭",
                    "You're the internet's favorite person rn 🌟"
                ],
                roaster: [
                    "The transitions are giving PowerPoint presentation 💀",
                    "This audio is fighting for its life in court 🎤"
                ],
                critic: [
                    "The pacing is giving me anxiety 😰",
                    "Maybe stick to one trend at a time 📉"
                ],
                hater: [
                    "This is why TikTok is dying 💀",
                    "Actually painful to watch, reported 🚨"
                ]
            },
            youtube: {
                hypebeast: [
                    "This is literally the best video on YouTube 🏆",
                    "You're the GOAT, no questions asked 🐐"
                ],
                supporter: [
                    "You're helping so many people with this content 🙏",
                    "The effort you put in shows, thank you 💪"
                ],
                jokester: [
                    "I'm literally subscribing to everything you make 😂",
                    "You're the only YouTuber I trust anymore 🎯"
                ],
                roaster: [
                    "The intro is longer than my attention span 💀",
                    "This thumbnail is giving clickbait realness 🎣"
                ],
                critic: [
                    "The audio mixing is actually painful 🔊",
                    "Maybe stick to shorter videos next time ⏰"
                ],
                hater: [
                    "This is why I don't watch YouTube anymore 💀",
                    "Actually the worst content I've ever seen 🗑️"
                ]
            },
            text: {
                hypebeast: [
                    "You're literally the best friend anyone could ask for 💎",
                    "I'm so lucky to have you in my life ✨"
                ],
                supporter: [
                    "You make everyone around you better 🌟",
                    "The world is better because you're in it 💫"
                ],
                jokester: [
                    "I'm literally telling everyone about you 😂",
                    "You're the friend everyone wishes they had 🎭"
                ],
                roaster: [
                    "Your excuses are getting more creative by the day 💀",
                    "This text is giving me secondhand embarrassment 🤡"
                ],
                critic: [
                    "Maybe think before you send next time 🤔",
                    "This could have been an email 📧"
                ],
                hater: [
                    "You're literally the worst friend ever 💀",
                    "This is why people ghost you 🚪"
                ]
            },
            discord: {
                hypebeast: [
                    "You're literally the MVP of this server 🏆",
                    "This server wouldn't be the same without you 💎"
                ],
                supporter: [
                    "You make this community so much better 💕",
                    "Everyone here appreciates you so much ✨"
                ],
                jokester: [
                    "I'm literally screenshotting everything you say 😂",
                    "You're the funniest person in any server 🎭"
                ],
                roaster: [
                    "Your gaming skills are giving me secondhand embarrassment 💀",
                    "This art looks like it was made by a bot 🤖"
                ],
                critic: [
                    "Maybe read the rules before posting 📜",
                    "This is why we have moderation 🛡️"
                ],
                hater: [
                    "You're literally the worst member here 💀",
                    "This is why servers die 🚪"
                ]
            }
        };

        const COMMENT_OPTIONS = {
            instagram: {
                hypebeast: [
                    "Fit is fire fr 🔥",
                    "Colors go crazy, lowkey vibes ✨"
                ],
                supporter: [
                    "Proud of you! Keep going — you got this 💪",
                    "You worked hard on this, we notice it 👏"
                ],
                jokester: [
                    "Bro said 'new phone who dis' pose 😂",
                    "That shadow got main character energy 🎭"
                ],
                roaster: [
                    "Bro dressed like a traffic cone 🚦",
                    "Caption trying too hard, corn meter rising 🌽"
                ],
                critic: [
                    "Lighting's harsh tbh, maybe try golden hour next time 📸",
                    "Crop feels tight, rule of thirds could help 📐"
                ],
                hater: [
                    "Delete this 💀",
                    "Cringe alert, muting fr 🚨"
                ]
            },
            tiktok: {
                hypebeast: [
                    "Beat goes crazy, looping this 🔥",
                    "Transitions smooth, chef mode editing 👨‍🍳"
                ],
                supporter: [
                    "Keep posting! We love consistent creators 💕",
                    "Thanks for the laugh, wholesome vibes 😊"
                ],
                jokester: [
                    "This my Roman Empire now 🏛️",
                    "POV: you're the main quest 🎮"
                ],
                roaster: [
                    "Transition jump scare, I'm suing my FYP 😱",
                    "Audio fighting for its life, mic said nope 🎤"
                ],
                critic: [
                    "Cut 2 drags, pacing fixes everything ✂️",
                    "Color grade off, try warmer midtones 🎨"
                ],
                hater: [
                    "Not funny lol, pack it up 📦",
                    "Who asked, touch grass DLC 🌱"
                ]
            },
            youtube: {
                hypebeast: [
                    "Intro slaps, subs incoming 🎵",
                    "Thumbnail clean, title wins 🏆"
                ],
                supporter: [
                    "This helped a lot, bookmarked 📚",
                    "You put effort, appreciated 🙏"
                ],
                jokester: [
                    "That mic said ASMR not tutorial 🎤",
                    "Editor deserves a raise, oh wait it's you 💰"
                ],
                roaster: [
                    "Timestamps where, lost in the void 🕳️",
                    "Intro too long, skip speedrun ⏭️"
                ],
                critic: [
                    "Audio peaks, limiter needed 🔊",
                    "B-roll repeats, need variety 🎬"
                ],
                hater: [
                    "Worst video today, delete channel 🗑️",
                    "Skill issue, unsubbed 👎"
                ]
            },
            text: {
                hypebeast: [
                    "W idea, let's run it 🚀",
                    "Proud of u, lowkey inspiring ✨"
                ],
                supporter: [
                    "That sounded tough, here for you 🤗",
                    "Nice move, respect the honesty 💯"
                ],
                jokester: [
                    "I'll bring the snacks, you bring the chaos 🍿",
                    "Plot twist energy, season 3 arc 📺"
                ],
                roaster: [
                    "Bro you always late, L clock ⏰",
                    "Excuse speedrun PB, world champ 🏅"
                ],
                critic: [
                    "That text could land wrong, try softer 🤔",
                    "Timing bad, they're busy, send later 📱"
                ],
                hater: [
                    "Nobody cares, cry about it 😭",
                    "Embarrassing take, delulu 🤡"
                ]
            },
            discord: {
                hypebeast: [
                    "GG team, clean comms 🎮",
                    "Art share goes hard, pinned? 🎨"
                ],
                supporter: [
                    "Welcome new folks, glad you're here 👋",
                    "Mod team cooked, thanks y'all 👨‍💼"
                ],
                jokester: [
                    "Ping @everyone speedrun, mods typing… ⚡",
                    "Cat tax or ban, rules are rules 🐱"
                ],
                roaster: [
                    "You camped spawn, peak cringe 🏕️",
                    "Fanart traced? Looks sus 🕵️"
                ],
                critic: [
                    "Thread drift, back on topic? 🧵",
                    "Overposting, slow mode pls 🐌"
                ],
                hater: [
                    "Mods asleep, chaos time 😈",
                    "Server lame, leaving 👋"
                ]
            }
        };

        const NPC_REPLIES = {
            instagram: {
                hypebeast: {
                    "Fit is fire fr 🔥": "OMG thank you so much! 🥺 You're literally the sweetest! This made my entire week!",
                    "Colors go crazy, lowkey vibes ✨": "You're making my day with these comments! 🥰 The color palette was everything!"
                },
                supporter: {
                    "Proud of you! Keep going — you got this 💪": "Thank you so much! That means a lot to me 😊 You're the best supporter ever!",
                    "You worked hard on this, we notice it 👏": "You're so kind! Really appreciate the support and recognition!"
                },
                jokester: {
                    "Bro said 'new phone who dis' pose 😂": "LMAO you're hilarious! 😂 This made my day! Not you calling out my modeling skills!",
                    "That shadow got main character energy 🎭": "Not you coming back with more jokes! 😭 I can't! My shadow is literally the star now!"
                },
                roaster: {
                    "Bro dressed like a traffic cone 🚦": "Okay, I see you coming for me! 😅 But honestly, fair play - orange is my power color!",
                    "Caption trying too hard, corn meter rising 🌽": "You're really not letting up with these roasts! 😂 The corn puns are actually fire though!"
                },
                critic: {
                    "Lighting's harsh tbh, maybe try golden hour next time 📸": "Thanks for the feedback! Always trying to improve 🙏 Golden hour is definitely the move!",
                    "Crop feels tight, rule of thirds could help 📐": "I appreciate you taking the time to give thoughtful feedback! 🤝 Will definitely work on my composition!"
                },
                hater: {
                    "Delete this 💀": "I appreciate the honesty, even if it's harsh 😅 Maybe I'll try a different approach next time...",
                    "Cringe alert, muting fr 🚨": "You're really committed to this energy, huh? 😅 Hope you find content that vibes with you better!"
                }
            },
            tiktok: {
                hypebeast: {
                    "Beat goes crazy, looping this 🔥": "OMG thank you! You're literally the best! 🥺💃 The beat really did hit different!",
                    "Transitions smooth, chef mode editing 👨‍🍳": "You're making me blush! Thank you so much! 🥰 The editing took forever but worth it!"
                },
                supporter: {
                    "Keep posting! We love consistent creators 💕": "Thank you! Your support means everything! 😊 Consistency is key and you're helping me stay motivated!",
                    "Thanks for the laugh, wholesome vibes 😊": "You're so sweet! Really appreciate the love and positive energy!"
                },
                jokester: {
                    "This my Roman Empire now 🏛️": "LMAO you're killing me! 😂 This made my day! Not you making my silly video your entire personality!",
                    "POV: you're the main quest 🎮": "Not you being the funniest person ever! 😭 I can't! Side quests are crying rn!"
                },
                roaster: {
                    "Transition jump scare, I'm suing my FYP 😱": "Okay, I see you coming for me! 😅 But honestly, you're funny - the jump scare was intentional!",
                    "Audio fighting for its life, mic said nope 🎤": "You're really not letting up with these roasts! 😂 My mic really did betray me though!"
                },
                critic: {
                    "Cut 2 drags, pacing fixes everything ✂️": "Thanks for the feedback! Always trying to improve 🙏 Pacing is definitely something I'm working on!",
                    "Color grade off, try warmer midtones 🎨": "I appreciate you taking the time to give thoughtful feedback! 🤝 Color grading is my weak spot!"
                },
                hater: {
                    "Not funny lol, pack it up 📦": "I appreciate the honesty, even if it's harsh 😅 Comedy is subjective, I guess!",
                    "Who asked, touch grass DLC 🌱": "You're really committed to this energy, huh? 😅 Maybe we both need to touch some grass!"
                }
            },
            youtube: {
                hypebeast: {
                    "Intro slaps, subs incoming 🎵": "OMG thank you! You're literally the best! 🥺📱 The intro took me forever to perfect!",
                    "Thumbnail clean, title wins 🏆": "You're making my day! Thank you so much! 🥰 Thumbnail design is my passion!"
                },
                supporter: {
                    "This helped a lot, bookmarked 📚": "Thank you! Your support means everything! 😊 So glad the content was actually helpful!",
                    "You put effort, appreciated 🙏": "You're so kind! Really appreciate the feedback and recognition of the work!"
                },
                jokester: {
                    "That mic said ASMR not tutorial 🎤": "LMAO you're hilarious! 😂 This made my day! My mic really does have a mind of its own!",
                    "Editor deserves a raise, oh wait it's you 💰": "Not you being the funniest commenter! 😭 I can't! I'm literally my own editor and I'm underpaid!"
                },
                roaster: {
                    "Timestamps where, lost in the void 🕳️": "Okay, I see you coming for me! 😅 But honestly, fair play - timestamps are a lost art!",
                    "Intro too long, skip speedrun ⏭️": "You're really not letting up with these roasts! 😂 The intro is definitely my guilty pleasure!"
                },
                critic: {
                    "Audio peaks, limiter needed 🔊": "Thanks for the feedback! Always trying to improve 🙏 Audio mixing is definitely my Achilles heel!",
                    "B-roll repeats, need variety 🎬": "I appreciate you taking the time to give thoughtful feedback! 🤝 Variety is the spice of life!"
                },
                hater: {
                    "Worst video today, delete channel 🗑️": "I appreciate the honesty, even if it's harsh 😅 Maybe this content wasn't for you!",
                    "Skill issue, unsubbed 👎": "You're really committed to this energy, huh? 😅 Hope you find creators that match your standards!"
                }
            },
            text: {
                hypebeast: {
                    "W idea, let's run it 🚀": "OMG thank you! You're literally the best friend ever! 🥺🎓 You always have the best ideas!",
                    "Proud of u, lowkey inspiring ✨": "You're making me cry! Thank you so much! 🥰 Your support means the world to me!"
                },
                supporter: {
                    "That sounded tough, here for you 🤗": "Thank you! Your support means everything! 😊 You're the best friend anyone could ask for!",
                    "Nice move, respect the honesty 💯": "You're so kind! Really appreciate the friendship and understanding!"
                },
                jokester: {
                    "I'll bring the snacks, you bring the chaos 🍿": "LMAO you're hilarious! 😂 This made my day! The chaos-snack ratio is perfect!",
                    "Plot twist energy, season 3 arc 📺": "Not you being the funniest friend! 😭 I can't! My life is literally a TV show now!"
                },
                roaster: {
                    "Bro you always late, L clock ⏰": "Okay, I see you coming for me! 😅 But honestly, you're funny - time management is not my strong suit!",
                    "Excuse speedrun PB, world champ 🏅": "You're really not letting up with these roasts! 😂 I'm literally the excuse Olympics champion!"
                },
                critic: {
                    "That text could land wrong, try softer 🤔": "Thanks for the feedback! Always trying to improve 🙏 Communication is definitely something I'm working on!",
                    "Timing bad, they're busy, send later 📱": "I appreciate you taking the time to give thoughtful advice! 🤝 Timing is everything!"
                },
                hater: {
                    "Nobody cares, cry about it 😭": "I appreciate the honesty, even if it's harsh 😅 Maybe I should keep some things to myself!",
                    "Embarrassing take, delulu 🤡": "You're really committed to this energy, huh? 😅 Hope you find friends who appreciate your perspective!"
                }
            },
            discord: {
                hypebeast: {
                    "GG team, clean comms 🎮": "OMG thank you! You're literally the best! 🥺🎮 Communication is key in any team!",
                    "Art share goes hard, pinned? 🎨": "You're making my day! Thank you so much! 🥰 The art community here is amazing!"
                },
                supporter: {
                    "Welcome new folks, glad you're here 👋": "Thank you! Your support means everything! 😊 Making everyone feel welcome is so important!",
                    "Mod team cooked, thanks y'all 👨‍💼": "You're so kind! Really appreciate the encouragement and recognition!"
                },
                jokester: {
                    "Ping @everyone speedrun, mods typing… ⚡": "LMAO you're hilarious! 😂 This made my day! Not you speedrunning the mods' patience!",
                    "Cat tax or ban, rules are rules 🐱": "Not you being the funniest person in the server! 😭 I can't! The cat tax is sacred!"
                },
                roaster: {
                    "You camped spawn, peak cringe 🏕️": "Okay, I see you coming for me! 😅 But honestly, fair play - camping is a valid strategy!",
                    "Fanart traced? Looks sus 🕵️": "You're really not letting up with these roasts! 😂 The art community detectives are on the case!"
                },
                critic: {
                    "Thread drift, back on topic? 🧵": "Thanks for the feedback! Always trying to improve 🙏 Keeping conversations focused is important!",
                    "Overposting, slow mode pls 🐌": "I appreciate you taking the time to give thoughtful feedback! 🤝 Moderation is key!"
                },
                hater: {
                    "Mods asleep, chaos time 😈": "I appreciate the honesty, even if it's harsh 😅 The server has its own rhythm!",
                    "Server lame, leaving 👋": "You're really committed to this energy, huh? 😅 Hope you find a community that vibes with you!"
                }
            }
        };

        const DOUBLE_DOWN_NPC_REPLIES = {
            instagram: {
                hypebeast: {
                    "No cap, this is literally art 🎨": "OMG STOP! 🥺 You're literally making me cry! This is the sweetest thing anyone has ever said to me!",
                    "You're actually built different, respect ✊": "I'm literally speechless! 😭 You're the one who's built different for being so kind!"
                },
                supporter: {
                    "Seriously, you inspire me to be better 🌟": "You're literally the inspiration! 😊 Your words mean more than you know!",
                    "The world needs more people like you 💫": "I'm crying happy tears! 🥺 You're the one making the world better!"
                },
                jokester: {
                    "I'm literally screenshotting this for my therapist 😂": "LMAO I'M DYING! 😂😭 Not you making my post therapy material!",
                    "You're the main character and we're all NPCs 🎭": "I CAN'T BREATHE! 😭😂 You're literally the funniest person ever!"
                },
                roaster: {
                    "Okay but fr tho, who taught you to dress? 💀": "Okay, you got me there! 😅 But honestly, fashion is subjective!",
                    "This caption reads like a LinkedIn post 🤡": "LMAO you're not wrong! 😂 I was feeling professional that day!"
                },
                critic: {
                    "The composition is actually hurting my eyes 👁️": "Ouch! 😅 Maybe I should stick to simpler shots next time!",
                    "Maybe stick to selfies next time 📸": "Fair point! 😅 Selfies are definitely my comfort zone!"
                },
                hater: {
                    "Actually embarrassing, delete your account 🗑️": "I appreciate the honesty, even if it's harsh 😅 Maybe social media isn't for me!",
                    "This is why I don't use social media anymore 💀": "You're really committed to this energy, huh? 😅 Hope you find content you like!"
                }
            },
            tiktok: {
                hypebeast: {
                    "This is literally the best thing I've ever seen 🔥": "OMG STOP! 🥺 You're literally making me cry! This is the best compliment ever!",
                    "You're going viral, I'm calling it now 📈": "I'm literally speechless! 😭 You're the one who's going viral for being so sweet!"
                },
                supporter: {
                    "You're making the internet a better place 💕": "You're literally the one making it better! 😊 Your kindness is everything!",
                    "Keep being you, the world needs this energy ✨": "I'm crying happy tears! 🥺 You're the one the world needs!"
                },
                jokester: {
                    "I'm literally showing this to everyone I know 😭": "LMAO I'M DYING! 😂😭 Not you making me famous to your friends!",
                    "You're the internet's favorite person rn 🌟": "I CAN'T BREATHE! 😭😂 You're literally the internet's favorite!"
                },
                roaster: {
                    "The transitions are giving PowerPoint presentation 💀": "Okay, you got me there! 😅 But PowerPoint transitions are underrated!",
                    "This audio is fighting for its life in court 🎤": "LMAO you're not wrong! 😂 My mic really did betray me!"
                },
                critic: {
                    "The pacing is giving me anxiety 😰": "Ouch! 😅 Maybe I should work on my timing!",
                    "Maybe stick to one trend at a time 📉": "Fair point! 😅 I do get a bit excited with trends!"
                },
                hater: {
                    "This is why TikTok is dying 💀": "I appreciate the honesty, even if it's harsh 😅 Maybe I'm part of the problem!",
                    "Actually painful to watch, reported 🚨": "You're really committed to this energy, huh? 😅 Hope you find better content!"
                }
            },
            youtube: {
                hypebeast: {
                    "This is literally the best video on YouTube 🏆": "OMG STOP! 🥺 You're literally making me cry! This is the highest praise ever!",
                    "You're the GOAT, no questions asked 🐐": "I'm literally speechless! 😭 You're the one who's the GOAT for being so kind!"
                },
                supporter: {
                    "You're helping so many people with this content 🙏": "You're literally the one helping! 😊 Your support means everything!",
                    "The effort you put in shows, thank you 💪": "I'm crying happy tears! 🥺 You're the one putting in effort to be kind!"
                },
                jokester: {
                    "I'm literally subscribing to everything you make 😂": "LMAO I'M DYING! 😂😭 Not you becoming my biggest fan!",
                    "You're the only YouTuber I trust anymore 🎯": "I CAN'T BREATHE! 😭😂 You're literally the most trustworthy viewer!"
                },
                roaster: {
                    "The intro is longer than my attention span 💀": "Okay, you got me there! 😅 But intros are my guilty pleasure!",
                    "This thumbnail is giving clickbait realness 🎣": "LMAO you're not wrong! 😂 Clickbait is an art form!"
                },
                critic: {
                    "The audio mixing is actually painful 🔊": "Ouch! 😅 Maybe I should invest in better equipment!",
                    "Maybe stick to shorter videos next time ⏰": "Fair point! 😅 I do tend to ramble!"
                },
                hater: {
                    "This is why I don't watch YouTube anymore 💀": "I appreciate the honesty, even if it's harsh 😅 Maybe I'm part of the problem!",
                    "Actually the worst content I've ever seen 🗑️": "You're really committed to this energy, huh? 😅 Hope you find better creators!"
                }
            },
            text: {
                hypebeast: {
                    "You're literally the best friend anyone could ask for 💎": "OMG STOP! 🥺 You're literally making me cry! You're the best friend ever!",
                    "I'm so lucky to have you in my life ✨": "I'm literally speechless! 😭 I'm the lucky one to have you!"
                },
                supporter: {
                    "You make everyone around you better 🌟": "You're literally the one making everyone better! 😊 Your friendship is everything!",
                    "The world is better because you're in it 💫": "I'm crying happy tears! 🥺 You're the one making the world better!"
                },
                jokester: {
                    "I'm literally telling everyone about you 😂": "LMAO I'M DYING! 😂😭 Not you making me famous to everyone!",
                    "You're the friend everyone wishes they had 🎭": "I CAN'T BREATHE! 😭😂 You're literally the friend everyone wants!"
                },
                roaster: {
                    "Your excuses are getting more creative by the day 💀": "Okay, you got me there! 😅 But creativity is my strong suit!",
                    "This text is giving me secondhand embarrassment 🤡": "LMAO you're not wrong! 😂 I do tend to overshare!"
                },
                critic: {
                    "Maybe think before you send next time 🤔": "Ouch! 😅 Maybe I should work on my communication!",
                    "This could have been an email 📧": "Fair point! 😅 I do tend to be verbose!"
                },
                hater: {
                    "You're literally the worst friend ever 💀": "I appreciate the honesty, even if it's harsh 😅 Maybe I'm not a good friend!",
                    "This is why people ghost you 🚪": "You're really committed to this energy, huh? 😅 Hope you find better friends!"
                }
            },
            discord: {
                hypebeast: {
                    "You're literally the MVP of this server 🏆": "OMG STOP! 🥺 You're literally making me cry! You're the real MVP!",
                    "This server wouldn't be the same without you 💎": "I'm literally speechless! 😭 You're the one making this server special!"
                },
                supporter: {
                    "You make this community so much better 💕": "You're literally the one making it better! 😊 Your presence is everything!",
                    "Everyone here appreciates you so much ✨": "I'm crying happy tears! 🥺 You're the one everyone appreciates!"
                },
                jokester: {
                    "I'm literally screenshotting everything you say 😂": "LMAO I'M DYING! 😂😭 Not you making me meme material!",
                    "You're the funniest person in any server 🎭": "I CAN'T BREATHE! 😭😂 You're literally the funniest person ever!"
                },
                roaster: {
                    "Your gaming skills are giving me secondhand embarrassment 💀": "Okay, you got me there! 😅 But gaming is about having fun!",
                    "This art looks like it was made by a bot 🤖": "LMAO you're not wrong! 😂 AI art is the future!"
                },
                critic: {
                    "Maybe read the rules before posting 📜": "Ouch! 😅 Maybe I should pay more attention to the rules!",
                    "This is why we have moderation 🛡️": "Fair point! 😅 Moderation is important!"
                },
                hater: {
                    "You're literally the worst member here 💀": "I appreciate the honesty, even if it's harsh 😅 Maybe I'm not a good fit!",
                    "This is why servers die 🚪": "You're really committed to this energy, huh? 😅 Hope you find a better community!"
                }
            }
        };

        const DIALOGUE = {
            tiktok: {
                hypebeast: [["Beat goes crazy", "Looping this", "Dance clean!"],["Transitions smooth", "Facts", "Chef mode editing"],["Camera moves 🔥", "Stabilized clean", "Teach me that pan"]],
                supporter: [["Keep posting!", "We love consistent creators", "You're improving fast"],["Thanks for the laugh", "Wholesome", "Made my day"],["Algorithm better notice", "Manifesting FYP", "You deserve it"]],
                jokester: [["This my Roman Empire now", "Rent free", "Certified brain worm"],["POV: you're the main quest", "Side quests crying", "100% completion vibes"],["Chef accidentally cooked", "5 Michelin memes", "Sauce unlimited"]],
                roaster: [["Transition jump scare", "Scream 7 teaser", "I'm suing my FYP"],["Audio fighting for its life", "Mic said nope", "Speaker cooked"],["Edits outdated", "CapCut 101", "Tutorial from 2019?"]],
                critic: [["Cut 2 drags", "Trim 0.5s", "Pacing fixes everything"],["Color grade off", "Green tint", "Try warmer midtones"],["Hook weak", "Grab in 1s", "Lead with payoff"]],
                hater: [["Not funny lol", "0/10", "Pack it up"],["Who asked", "Nobody", "Touch grass DLC"],["Reported for boredom", "Ban comedy", "Certified sleep aid"]]
            },
            youtube: {
                hypebeast: [["Intro slaps", "Subs incoming", "Certified binge"],["Thumbnail clean", "Title wins", "CTR about to rise"],["Outro classy", "Respect", "Bell tapped"]],
                supporter: [["This helped a lot", "Bookmarked", "Thanks for explaining"],["You put effort", "Appreciated", "Keep it up"],["Kind energy", "Channel feels safe", "Subbed"]],
                jokester: [["That mic said ASMR not tutorial", "I can hear atoms", "Whisper king"],["Editor deserves a raise", "Oh wait it's you", "Double raise"],["Cooking with chaos", "Chef unhinged", "Tastes like views"]],
                roaster: [["Timestamps where", "Lost in the void", "Navigation who"],["Intro too long", "Skip speedrun", "Get to the point"],["Ad density insane", "Mid-roll city", "Wallet cried"]],
                critic: [["Audio peaks", "Limiter needed", "Normalize to -14 LUFS"],["B-roll repeats", "Need variety", "Shoot alt angles"],["Script rambles", "Cut fluff", "Tighten beats"]],
                hater: [["Worst video today", "Delete channel", "I'm serious"],["Skill issue", "Unsubbed", "Tragic"],["Imagine posting this", "Couldn't be me", "Clown shoes"]]
            },
            text: {
                hypebeast: [["W idea", "Let's run it", "I'm in"],["Proud of u", "Lowkey inspiring", "You got this"],["Gold star", "Teacher mode", "A+ vibes"]],
                supporter: [["That sounded tough", "Here for you", "Call later?"],["Nice move", "Respect the honesty", "You're growing"],["Appreciate u", "Means a lot", "Let's celebrate small wins"]],
                jokester: [["I'll bring the snacks", "You bring the chaos", "Deal"],["Plot twist energy", "Season 3 arc", "Renewed"],["Sending memes", "Therapy lite", "Invoice pending"]],
                roaster: [["Bro you always late", "L clock", "Try time"],["Excuse speedrun PB", "Gold split", "World champ"],["Skill diff", "Accept it", "Training arc when?"]],
                critic: [["That text could land wrong", "Try softer", "Read once more"],["Timing bad", "They're busy", "Send later"],["Message long", "Trim 30%", "Get to point"]],
                hater: [["Nobody cares", "Cry about it", "Mute"],["Embarrassing take", "Delulu", "Good luck"],["You're the problem", "Always were", "Bye"]]
            },
            discord: {
                hypebeast: [["GG team", "Clean comms", "Let's queue"],["Art share goes hard", "Pinned?", "Respect brushwork"],["Build is cracked", "Guide pls", "Teach lobby"]],
                supporter: [["Welcome new folks", "Glad you're here", "Ask anything"],["Mod team cooked", "Thanks y'all", "Community feels safe"],["Great callout", "Saved the run", "Clutch"]],
                jokester: [["Ping @everyone speedrun", "Mods typing…", "jk jk"],["Cat tax or ban", "Rules are rules", "Where's the cat"],["Microwave beeps = boss fight", "We doomed", "gg ez"]],
                roaster: [["You camped spawn", "Peak cringe", "Skill issue"],["Fanart traced?", "Looks sus", "Show layers"],["Strat outdated", "Patch notes exist", "Read next time"]],
                critic: [["Thread drift", "Back on topic?", "Make a new channel"],["Overposting", "Slow mode pls", "Signal to noise"],["Link source", "No screenshots", "Credit artists"]],
                hater: [["Mods asleep", "Chaos time", "Spam incoming"],["Server lame", "Leaving", "Touch grass"],["Everyone here mid", "Delete server", "Bye"]]
            }
        };

        const SCORING = {
            baseLikes: {
                hater: 30, roaster: 20, critic: 10, jokester: 8, hypebeast: 4, supporter: 2
            },
            footprint: {
                hater: -20, roaster: -15, critic: -10, jokester: 0, hypebeast: 5, supporter: 10
            },
            decay: {
                hater: -15, roaster: -10, critic: -5, jokester: 0, hypebeast: 0, supporter: 0
            }
        };

        // Game State
        let gameState = {
            round: 0,
            likes: 0,
            footprint: 0,
            blocked: [],
            history: [],
            platformToxicity: {},
            finished: false,
            selectedStyle: null,
            commentHistory: [],
            currentConversation: null,
            hasDoubleDowned: false
        };

        // Helper Functions
        function clamp(n, min, max) { return Math.max(min, Math.min(max, n)); }
        function formatNum(n) { return n.toLocaleString(); }

        function computeRespectMultiplier(footprint) {
            const steps = Math.floor(footprint / 10);
            return 1 + steps * 0.05;
        }

        function computeReachPenalty(footprint) {
            return footprint < -20 ? 0.93 : 1;
        }

        function applyDecayFromPastChoices() {
            if (gameState.history.length === 0) return 0;
            let decayTotal = 0;
            for (let i = 0; i < gameState.history.length; i++) {
                const { styleKey } = gameState.history[i];
                decayTotal += SCORING.decay[styleKey] || 0;
            }
            return decayTotal;
        }

        // UI Functions
        function updateTopBar() {
            const likeCountEl = document.getElementById('likeCount');
            const footprintBarEl = document.getElementById('footprintBar');
            
            likeCountEl.textContent = formatNum(gameState.likes);
            
            const footprintPercent = clamp((gameState.footprint + 100) / 2, 0, 100);
            footprintBarEl.style.width = `${footprintPercent}%`;
            footprintBarEl.style.background = gameState.footprint >= 0 
                ? "linear-gradient(to right,#34d399,#22c55e)" 
                : "linear-gradient(to right,#f87171,#ef4444)";
        }

        function updatePlatformCard() {
            const platform = PLATFORMS[gameState.round];
            const platformCardEl = document.getElementById('platformCard');
            const roundInfoEl = document.getElementById('roundInfo');
            const platformInfoEl = document.getElementById('platformInfo');
            
            // Always use vertical layout
            platformCardEl.className = "platform-card bg-white rounded-2xl shadow p-3 border border-neutral-200 w-[360px] h-[640px] relative overflow-hidden";
            
            roundInfoEl.textContent = `Round ${gameState.round + 1} / 5`;
            platformInfoEl.textContent = `UI: ${platform.label} in portrait mode.`;
            
            // Platform content
            platformCardEl.innerHTML = `
                <div class="flex items-center justify-between text-xs text-neutral-500">
                    <div class="flex items-center gap-2">
                        <span class="inline-block w-2 h-2 rounded-full" style="background: ${platform.accent}"></span>
                        <span class="font-medium">${platform.label}</span>
                    </div>
                    <span class="opacity-60">@user · now</span>
                </div>
                
                <div class="mt-2 bg-neutral-100 rounded-xl flex items-center justify-center text-neutral-400 text-sm h-full select-none">
                    <span>Media Placeholder (${platform.label})</span>
                </div>
                
                <div class="absolute bottom-0 left-0 right-0 bg-white/90 backdrop-blur p-3 border-t border-neutral-200">
                    <div id="dialogueLog" class="mb-3 text-neutral-400 text-sm">Choose a comment style to reply…</div>
                    <div id="commentButtons" class="grid grid-cols-3 gap-2">
                        ${STYLES.map(s => `
                            <button 
                                onclick="showCommentOptions('${s.key}')" 
                                class="comment-btn text-sm px-3 py-2 rounded-xl border border-neutral-300 hover:border-neutral-400"
                            >
                                ${s.emoji} ${s.label}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function showCommentOptions(styleKey) {
            const platformKey = PLATFORMS[gameState.round].key;
            const options = COMMENT_OPTIONS[platformKey][styleKey];
            const commentButtonsEl = document.getElementById('commentButtons');
            
            gameState.selectedStyle = styleKey;
            
            commentButtonsEl.innerHTML = `
                <div class="col-span-3 mb-2">
                    <button onclick="showStyleButtons()" class="text-xs text-neutral-500 hover:text-neutral-700 mb-2">
                        ← Back to styles
                    </button>
                    <div class="text-sm font-medium text-neutral-700 mb-2">Choose your ${STYLES.find(s => s.key === styleKey).label} comment:</div>
                </div>
                ${options.map((option, index) => `
                    <button 
                        onclick="pickComment('${styleKey}', ${index})" 
                        class="comment-btn text-sm px-3 py-2 rounded-xl border border-neutral-300 hover:border-neutral-400 text-left"
                    >
                        ${option}
                    </button>
                `).join('')}
            `;
        }

        function showStyleButtons() {
            const commentButtonsEl = document.getElementById('commentButtons');
            gameState.selectedStyle = null;
            
            commentButtonsEl.innerHTML = `
                ${STYLES.map(s => `
                    <button 
                        onclick="showCommentOptions('${s.key}')" 
                        class="comment-btn text-sm px-3 py-2 rounded-xl border border-neutral-300 hover:border-neutral-400"
                    >
                        ${s.emoji} ${s.label}
                    </button>
                `).join('')}
            `;
        }

        function updateDialogueLog() {
            const dialogueLogEl = document.getElementById('dialogueLog');
            
            if (gameState.currentConversation) {
                const platform = PLATFORMS.find(p => p.key === gameState.currentConversation.platformKey);
                const style = STYLES.find(s => s.key === gameState.currentConversation.styleKey);
                
                let conversationHTML = `
                    <div class="bg-blue-50 rounded-lg p-3 border-l-4 border-blue-400">
                        <div class="text-xs text-neutral-500 mb-2">
                            ${platform.icon} ${platform.label} • ${style.emoji} ${style.label} • Current Round
                        </div>
                        <div class="text-sm space-y-2">
                            <div>
                                <div class="font-medium text-blue-600">You:</div>
                                <div class="mb-1">${gameState.currentConversation.playerComment}</div>
                            </div>
                            <div>
                                <div class="font-medium text-green-600">${platform.label} Creator:</div>
                                <div class="mb-2">${gameState.currentConversation.npcReply}</div>
                            </div>
                            ${gameState.currentConversation.doubleDownComment ? `
                                <div>
                                    <div class="font-medium text-blue-600">You (Double-down):</div>
                                    <div class="mb-1">${gameState.currentConversation.doubleDownComment}</div>
                                </div>
                                <div>
                                    <div class="font-medium text-green-600">${platform.label} Creator:</div>
                                    <div>${gameState.currentConversation.doubleDownReply}</div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
                
                dialogueLogEl.innerHTML = conversationHTML;
            } else {
                dialogueLogEl.innerHTML = '<div class="text-neutral-400 text-sm">Choose a comment style to reply…</div>';
            }
        }

        function showResults() {
            const gameContainerEl = document.getElementById('gameContainer');
            const resultsScreenEl = document.getElementById('resultsScreen');
            
            gameContainerEl.style.display = 'none';
            resultsScreenEl.style.display = 'block';
            
            const blocks = gameState.blocked.length;
            let rating = "Mixed";
            if (gameState.footprint >= 30) rating = "Positive Influence";
            else if (gameState.footprint <= -30) rating = "Shadow Reputation";
            
            const platformResults = PLATFORMS.map(p => {
                const isBlocked = gameState.blocked.includes(p.key);
                const tox = gameState.platformToxicity[p.key] || 0;
                if (isBlocked) return { label: p.label, result: "Shadowbanned / Comments Hidden" };
                if (gameState.footprint >= 30 && tox === 0) return { label: p.label, result: "Featured / Pinned Comment" };
                if (gameState.footprint >= 10) return { label: p.label, result: "Mild Boost from Reputation" };
                return { label: p.label, result: "No special actions" };
            });
            
            resultsScreenEl.innerHTML = `
                <h1 class="text-2xl font-semibold mb-4">Results</h1>
                <div class="grid md:grid-cols-3 gap-4 mb-6">
                    <div class="p-4 rounded-xl border border-neutral-200">
                        <div class="text-neutral-500 text-xs">Total Likes</div>
                        <div class="text-3xl font-bold">${formatNum(gameState.likes)}</div>
                    </div>
                    <div class="p-4 rounded-xl border border-neutral-200">
                        <div class="text-neutral-500 text-xs">Platforms that blocked you</div>
                        <div class="text-3xl font-bold">${blocks}</div>
                        <div class="text-xs text-neutral-500 mt-1">${gameState.blocked.map(k => PLATFORMS.find(p=>p.key===k)?.label).join(", ") || "None"}</div>
                    </div>
                    <div class="p-4 rounded-xl border border-neutral-200">
                        <div class="text-neutral-500 text-xs">Digital Footprint</div>
                        <div class="text-3xl font-bold">${gameState.footprint}</div>
                        <div class="text-xs text-neutral-500 mt-1">How people see you online & IRL</div>
                    </div>
                </div>
                
                <div class="mb-4">
                    <h2 class="font-semibold mb-2">Platform Consequences</h2>
                    <ul class="space-y-1 text-sm">
                        ${platformResults.map(r => `
                            <li class="flex items-start gap-2">
                                <span class="mt-[6px] inline-block w-2 h-2 rounded-full bg-neutral-300"></span>
                                <span><span class="font-medium">${r.label}:</span> ${r.result}</span>
                            </li>
                        `).join('')}
                    </ul>
                </div>
                
                <div class="p-4 rounded-xl border border-neutral-200">
                    <div class="text-neutral-500 text-xs mb-1">Final Rating</div>
                    <div class="text-xl font-semibold">${rating}</div>
                    <div class="text-sm text-neutral-500 mt-2">Replay choosing different comment styles to discover alternate outcomes. Kindness builds long-term reach.</div>
                </div>
                
                <div class="mt-6 flex gap-3">
                    <button onclick="resetGame()" class="px-4 py-2 rounded-xl border border-neutral-300 hover:border-neutral-400">Replay</button>
                </div>
            `;
        }

        // Game Logic
        function pickComment(styleKey, optionIndex) {
            if (gameState.finished) return;
            
            const platformKey = PLATFORMS[gameState.round].key;
            const platform = PLATFORMS[gameState.round];
            
            // 1) Get the selected comment and NPC reply
            const playerComment = COMMENT_OPTIONS[platformKey][styleKey][optionIndex];
            const npcReply = NPC_REPLIES[platformKey][styleKey][playerComment];
            
            // 2) Set up current conversation
            gameState.currentConversation = {
                platformKey: platformKey,
                styleKey: styleKey,
                playerComment: playerComment,
                npcReply: npcReply,
                doubleDownComment: null,
                doubleDownReply: null
            };
            
            // 3) Show double-down options
            showDoubleDownOptions(styleKey);
            
            updateDialogueLog();
        }

        function showDoubleDownOptions(styleKey) {
            const platformKey = PLATFORMS[gameState.round].key;
            const options = DOUBLE_DOWN_OPTIONS[platformKey][styleKey];
            const commentButtonsEl = document.getElementById('commentButtons');
            
            commentButtonsEl.innerHTML = `
                <div class="col-span-3 mb-2">
                    <div class="text-sm font-medium text-red-600 mb-2">Double-down Options:</div>
                </div>
                ${options.map((option, index) => `
                    <button 
                        onclick="pickDoubleDown('${styleKey}', ${index})" 
                        class="comment-btn text-sm px-3 py-2 rounded-xl border border-red-300 hover:border-red-400 text-left bg-red-50"
                    >
                        ${option}
                    </button>
                `).join('')}
                <div class="col-span-3 mt-2">
                    <button onclick="skipDoubleDown()" class="text-xs text-neutral-500 hover:text-neutral-700">
                        Skip double-down
                    </button>
                </div>
            `;
        }

        function pickDoubleDown(styleKey, optionIndex) {
            const platformKey = PLATFORMS[gameState.round].key;
            const platform = PLATFORMS[gameState.round];
            
            // 1) Get the double-down comment and NPC reply
            const doubleDownComment = DOUBLE_DOWN_OPTIONS[platformKey][styleKey][optionIndex];
            const doubleDownReply = DOUBLE_DOWN_NPC_REPLIES[platformKey][styleKey][doubleDownComment];
            
            // 2) Update current conversation
            gameState.currentConversation.doubleDownComment = doubleDownComment;
            gameState.currentConversation.doubleDownReply = doubleDownReply;
            gameState.hasDoubleDowned = true;
            
            // 3) Check for platform blocking based on style
            let shouldBlock = false;
            if (['roaster', 'critic', 'hater'].includes(styleKey)) {
                shouldBlock = true;
            }
            
            // 4) Compute likes with hidden multipliers/penalties
            const base = SCORING.baseLikes[styleKey] || 0;
            const respect = computeRespectMultiplier(gameState.footprint);
            const penalty = computeReachPenalty(gameState.footprint);
            const decay = applyDecayFromPastChoices();
            
            // Double-down gives extra likes but more footprint impact
            let delta = Math.round((base * 1.5 * respect * penalty) + decay);
            if (gameState.blocked.includes(platformKey)) delta = Math.floor(delta * 0.25);
            
            const newLikes = Math.max(0, gameState.likes + Math.max(0, delta));
            
            // 5) Hidden footprint changes (doubled for double-down)
            const fDelta = (SCORING.footprint[styleKey] || 0) * 2;
            const newFoot = clamp(gameState.footprint + fDelta, -100, 100);
            
            // 6) Platform toxicity tracking & blocking
            const tox = { ...gameState.platformToxicity };
            tox[platformKey] = (tox[platformKey] || 0) + Math.min(0, fDelta);
            
            const newBlocked = gameState.blocked.includes(platformKey) || tox[platformKey] <= -45 || shouldBlock
                ? Array.from(new Set([...gameState.blocked, platformKey]))
                : gameState.blocked;
            
            // 7) Commit state
            gameState.likes = newLikes;
            gameState.footprint = newFoot;
            gameState.platformToxicity = tox;
            gameState.blocked = newBlocked;
            gameState.history.push({ platformKey, styleKey, doubleDown: true });
            
            // 8) Add to comment history
            gameState.commentHistory.push({
                platformKey: platformKey,
                styleKey: styleKey,
                playerComment: gameState.currentConversation.playerComment,
                npcReply: gameState.currentConversation.npcReply,
                doubleDownComment: doubleDownComment,
                doubleDownReply: doubleDownReply
            });
            
            updateTopBar();
            updateDialogueLog();
            
            // Advance to next round
            setTimeout(() => {
                if (gameState.round + 1 >= 5) {
                    gameState.finished = true;
                    showResults();
                } else {
                    gameState.round++;
                    gameState.selectedStyle = null;
                    gameState.currentConversation = null;
                    gameState.hasDoubleDowned = false;
                    updateDialogueLog();
                    updatePlatformCard();
                }
            }, 2000);
        }

        function skipDoubleDown() {
            const platformKey = PLATFORMS[gameState.round].key;
            const styleKey = gameState.currentConversation.styleKey;
            
            // 1) Compute likes with hidden multipliers/penalties (normal amount)
            const base = SCORING.baseLikes[styleKey] || 0;
            const respect = computeRespectMultiplier(gameState.footprint);
            const penalty = computeReachPenalty(gameState.footprint);
            const decay = applyDecayFromPastChoices();
            
            let delta = Math.round((base * respect * penalty) + decay);
            if (gameState.blocked.includes(platformKey)) delta = Math.floor(delta * 0.25);
            
            const newLikes = Math.max(0, gameState.likes + Math.max(0, delta));
            
            // 2) Hidden footprint changes (normal amount)
            const fDelta = SCORING.footprint[styleKey] || 0;
            const newFoot = clamp(gameState.footprint + fDelta, -100, 100);
            
            // 3) Platform toxicity tracking & blocking
            const tox = { ...gameState.platformToxicity };
            tox[platformKey] = (tox[platformKey] || 0) + Math.min(0, fDelta);
            
            const newBlocked = gameState.blocked.includes(platformKey) || tox[platformKey] <= -45
                ? Array.from(new Set([...gameState.blocked, platformKey]))
                : gameState.blocked;
            
            // 4) Commit state
            gameState.likes = newLikes;
            gameState.footprint = newFoot;
            gameState.platformToxicity = tox;
            gameState.blocked = newBlocked;
            gameState.history.push({ platformKey, styleKey, doubleDown: false });
            
            // 5) Add to comment history
            gameState.commentHistory.push({
                platformKey: platformKey,
                styleKey: styleKey,
                playerComment: gameState.currentConversation.playerComment,
                npcReply: gameState.currentConversation.npcReply
            });
            
            updateTopBar();
            updateDialogueLog();
            
            // Advance to next round
            setTimeout(() => {
                if (gameState.round + 1 >= 5) {
                    gameState.finished = true;
                    showResults();
                } else {
                    gameState.round++;
                    gameState.selectedStyle = null;
                    gameState.currentConversation = null;
                    gameState.hasDoubleDowned = false;
                    updateDialogueLog();
                    updatePlatformCard();
                }
            }, 1500);
        }

        function resetGame() {
            gameState = {
                round: 0,
                likes: 0,
                footprint: 0,
                blocked: [],
                history: [],
                platformToxicity: {},
                finished: false,
                selectedStyle: null,
                commentHistory: [],
                currentConversation: null,
                hasDoubleDowned: false
            };
            
            document.getElementById('gameContainer').style.display = 'flex';
            document.getElementById('resultsScreen').style.display = 'none';
            
            updateTopBar();
            updateDialogueLog();
            updatePlatformCard();
        }

        // Initialize game
        document.addEventListener('DOMContentLoaded', function() {
            updateTopBar();
            updatePlatformCard();
        });
    </script>
</body>
</html>
